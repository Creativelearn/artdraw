!function(a,b){"object"===typeof exports&&"undefined"!==typeof module?module.exports=b():"function"===typeof define&&define.amd?define(b):(a=a||self,a.subjx=b())}(this,function(){"use strict";function a(b){"@babel/helpers - typeof";return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(b)}function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}function e(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function f(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function g(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?f(Object(c),!0).forEach(function(b){e(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):f(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function h(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&j(a,b)}function i(a){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function j(a,b){return(j=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}function k(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function l(a,b){if(null==a)return{};var e,f,c={},d=Object.keys(a);for(f=0;f<d.length;f++)e=d[f],b.indexOf(e)>=0||(c[e]=a[e]);return c}function m(a,b){if(null==a)return{};var d,e,c=l(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(e=0;e<f.length;e++)d=f[e],b.indexOf(d)>=0||Object.prototype.propertyIsEnumerable.call(a,d)&&(c[d]=a[d])}return c}function n(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function o(a,b){return!b||"object"!==typeof b&&"function"!==typeof b?n(a):b}function p(a){return function(){var c,b=i(a);if(k()){var d=i(this).constructor;c=Reflect.construct(b,arguments,d)}else c=b.apply(this,arguments);return o(this,c)}}function q(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=i(a),null!==a););return a}function r(a,b,c){return(r="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){var d=q(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}})(a,b,c||a)}function s(a,b){return v(a)||x(a,b)||y(a,b)||B()}function t(a){return u(a)||w(a)||y(a)||A()}function u(a){return Array.isArray(a)?z(a):void 0}function v(a){return Array.isArray(a)?a:void 0}function w(a){return"undefined"!==typeof Symbol&&Symbol.iterator in Object(a)?Array.from(a):void 0}function x(a,b){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var h,g=a[Symbol.iterator]();!(d=(h=g.next()).done)&&(c.push(h.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{d||null==g["return"]||g["return"]()}finally{if(e)throw f}}return c}}function y(a,b){if(a){if("string"===typeof a)return z(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(c):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?z(a,b):void 0}}function z(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=a[c];return d}function A(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function B(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(a){if("undefined"===typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(a=y(a))){var b=0,c=function(){};return{s:c,n:function(){return b>=a.length?{done:!0}:{done:!1,value:a[b++]}},e:function(a){throw a},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,g,e=!0,f=!1;return{s:function(){d=a[Symbol.iterator]()},n:function(){var a=d.next();return e=a.done,a},e:function(a){f=!0,g=a},f:function(){try{e||null==d.return||d.return()}finally{if(f)throw g}}}}function S(a,b,c,d,e,f){var g=function(a){for(var b=a.target;b&&b!==this;)b.matches(c)&&d.call(b,a),b=b.parentNode};f===!0?document.addEventListener?a.addEventListener(b,g,e||{passive:!1}):document.attachEvent?a.attachEvent("on".concat(b),g):a["on".concat(b)]=g:document.removeEventListener?a.removeEventListener(b,g,e||{passive:!1}):document.detachEvent?a.detachEvent("on".concat(b),g):a["on".concat(b)]=null}function T(b){return N(b)&&"object"===a(b)&&(Array.isArray(b)||N(window.Symbol)&&"function"===typeof b[window.Symbol.iterator]||N(b.forEach)||"number"===typeof b.length&&(0===b.length||b.length>0&&b.length-1 in b))}function U(a){return new R(a)}function td(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=document.createElementNS("http://www.w3.org/2000/svg",a);return b.forEach(function(a){return Yb(c,a)}),c}function ge(a,b){if(this.length){var c=N(b)&&b instanceof Hb?b:new Hb;if(this[0]instanceof SVGElement){var d=J.call(this,function(a,b){return Fd(b)&&a.push(b),a},[]);return new $d(d,a,c)}return new ld(I.call(this,function(a){return a}),a,c)}}function le(a){return this.length?new ke(I.call(this,function(a){return a}),a):void 0}function ne(a){return new me(a)}var D=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,1e3/60)},E=window.cancelAnimationFrame||window.mozCancelAnimationFrame||function(a){clearTimeout(a)},F=Array.prototype,G=F.forEach,H=F.slice,I=F.map,J=F.reduce,K=console,L=K.warn,M=function(a){return a},N=function(a){return void 0!==a&&null!==a},O=function(a){return void 0===a||null===a},P=function(a){return"function"===typeof a},Q=function(a){return P(a)?function(){a.call.apply(a,[this].concat(Array.prototype.slice.call(arguments)))}:M},R=function(){function c(d){if(b(this,c),"string"===typeof d){var e=document.querySelectorAll(d);this.length=e.length;for(var f=0;f<this.length;f++)this[f]=e[f]}else if("object"!==a(d)||1!==d.nodeType&&d!==document)if(d instanceof c){this.length=d.length;for(var g=0;g<this.length;g++)this[g]=d[g]}else{if(!T(d))throw new Error("Passed parameter must be selector/element/elementArray");this.length=d.length;for(var h=0;h<this.length;h++)1===d[h].nodeType&&(this[h]=d[h])}else this[0]=d,this.length=1}return d(c,[{key:"css",value:function(b){var c=function(a){for(var c=a.length;c--;)return a[c].currentStyle?a[c].currentStyle[b]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(a[c],"")[b]:a[c].style[b]},d=function(a,b){for(var c=a.length;c--;)for(var d in b)a[c].style[d]=b[d];return a.style},e={setStyle:function(a){return d(this,a)},getStyle:function(){return c(this)}};return"string"===typeof b?e.getStyle.apply(this,H.call(arguments,1)):"object"!==a(b)&&b?(L("Method ".concat(b," does not exist")),!1):e.setStyle.apply(this,arguments)}},{key:"on",value:function(){for(var a=this.length;a--;)this[a].events||(this[a].events={},this[a].events[arguments[0]]=[]),"string"!==typeof arguments[1]?document.addEventListener?this[a].addEventListener(arguments[0],arguments[1],arguments[2]||{passive:!1}):document.attachEvent?this[a].attachEvent("on".concat(arguments[0]),arguments[1]):this[a]["on".concat(arguments[0])]=arguments[1]:S(this[a],arguments[0],arguments[1],arguments[2],arguments[3],!0);return this}},{key:"off",value:function(){for(var a=this.length;a--;)this[a].events||(this[a].events={},this[a].events[arguments[0]]=[]),"string"!==typeof arguments[1]?document.removeEventListener?this[a].removeEventListener(arguments[0],arguments[1],arguments[2]):document.detachEvent?this[a].detachEvent("on".concat(arguments[0]),arguments[1]):this[a]["on".concat(arguments[0])]=null:S(this[a],arguments[0],arguments[1],arguments[2],arguments[3],!1);return this}},{key:"is",value:function(a){if(O(a))return!1;for(var b=U(a),c=this.length;c--;)if(this[c]===b[c])return!0;return!1}}]),c}(),V=2,W="#00a8ff",X="sjx-",Y="mousedown",Z="mouseup",$="mousemove",_="touchstart",ab="touchend",bb="touchmove",cb="dragStart",db="drag",eb="dragEnd",fb="resizeStart",gb="resize",hb="resizeEnd",ib="rotateStart",jb="rotate",kb="rotateEnd",lb="setPoint",mb="setPointStart",nb="setPointEnd",ob=[cb,db,,eb,fb,gb,hb,ib,jb,kb,mb,nb],pb=["","-webkit-","-moz-","-ms-","-o-"],qb="ongetstate",rb="onapply",sb="onmove",tb="onresize",ub="onrotate",vb=[qb,rb,sb,tb,ub],wb={NOTIFIER_EVENTS:vb,ON_GETSTATE:qb,ON_APPLY:rb,ON_MOVE:sb,ON_RESIZE:tb,ON_ROTATE:ub},xb={EMITTER_EVENTS:ob,E_DRAG_START:cb,E_DRAG:db,E_DRAG_END:eb,E_RESIZE_START:fb,E_RESIZE:gb,E_RESIZE_END:hb,E_ROTATE_START:ib,E_ROTATE:jb,E_ROTATE_END:kb,E_SET_POINT:lb,E_SET_POINT_START:mb,E_SET_POINT_END:nb},yb={E_MOUSEDOWN:Y,E_MOUSEUP:Z,E_MOUSEMOVE:$,E_TOUCHSTART:_,E_TOUCHEND:ab,E_TOUCHMOVE:bb},zb={TOP_LEFT:"tl",TOP_CENTER:"tc",TOP_RIGHT:"tr",BOTTOM_LEFT:"bl",BOTTOM_RIGHT:"br",BOTTOM_CENTER:"bc",MIDDLE_LEFT:"ml",MIDDLE_RIGHT:"mr",CENTER:"center"},Ab={TOP_EDGE:"te",BOTTOM_EDGE:"be",LEFT_EDGE:"le",RIGHT_EDGE:"re"},Bb={TRANSFORM_HANDLES_KEYS:zb,TRANSFORM_EDGES_KEYS:Ab},Cb=wb.ON_GETSTATE,Db=wb.ON_APPLY,Eb=wb.ON_MOVE,Fb=wb.ON_RESIZE,Gb=wb.ON_ROTATE,Hb=function(){function a(){b(this,a),this.observers={}}return d(a,[{key:"subscribe",value:function(a,b){var c=this.observers;return O(c[a])&&Object.defineProperty(c,a,{value:[]}),c[a].push(b),this}},{key:"unsubscribe",value:function(a,b){var c=this.observers;if(N(c[a])){var d=c[a].indexOf(b);c[a].splice(d,1)}return this}},{key:"notify",value:function(a,b,c){O(this.observers[a])||this.observers[a].forEach(function(d){if(b!==d)switch(a){case Eb:d.notifyMove(c);break;case Gb:d.notifyRotate(c);break;case Fb:d.notifyResize(c);break;case Db:d.notifyApply(c);break;case Cb:d.notifyGetState(c)}})}}]),a}(),Ib=function(){function a(c){b(this,a),this.name=c,this.callbacks=[]}return d(a,[{key:"registerCallback",value:function(a){this.callbacks.push(a)}},{key:"removeCallback",value:function(a){var b=this.callbacks(a);this.callbacks.splice(b,1)}}]),a}(),Jb=function(){function a(){b(this,a),this.events={}}return d(a,[{key:"registerEvent",value:function(a){this.events[a]=new Ib(a)}},{key:"emit",value:function(a,b,c){this.events[b].callbacks.forEach(function(b){b.call(a,c)})}},{key:"addEventListener",value:function(a,b){this.events[a].registerCallback(b)}},{key:"removeEventListener",value:function(a,b){this.events[a].removeCallback(b)}}]),a}(),Kb=xb.E_DRAG,Lb=yb.E_MOUSEMOVE,Mb=yb.E_MOUSEUP,Nb=yb.E_TOUCHMOVE,Ob=yb.E_TOUCHEND,Pb=function(){function a(c){b(this,a),this.elements=c,this.storage=null,this.proxyMethods=null,this.eventDispatcher=new Jb,this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._animate=this._animate.bind(this)}return d(a,[{key:"enable",value:function(a){this._processOptions(a),this._init(this.elements),this.proxyMethods.onInit.call(this,this.elements)}},{key:"disable",value:function(){Qb()}},{key:"_init",value:function(){Qb()}},{key:"_destroy",value:function(){Qb()}},{key:"_processOptions",value:function(){Qb()}},{key:"_start",value:function(){Qb()}},{key:"_moving",value:function(){Qb()}},{key:"_end",value:function(){Qb()}},{key:"_animate",value:function(){Qb()}},{key:"_drag",value:function(a){var b=a.element,c=a.dx,d=a.dy,e=m(a,["element","dx","dy"]),f=this._processMove(b,{dx:c,dy:d}),h=g({dx:c,dy:d,transform:f},e);this.proxyMethods.onMove.call(this,h),this._emitEvent(Kb,h)}},{key:"_draw",value:function(){this._animate()}},{key:"_onMouseDown",value:function(a){this._start(a),U(document).on(Lb,this._onMouseMove).on(Mb,this._onMouseUp)}},{key:"_onTouchStart",value:function(a){this._start(a.touches[0]),U(document).on(Nb,this._onTouchMove).on(Ob,this._onTouchEnd)}},{key:"_onMouseMove",value:function(a){a.preventDefault&&a.preventDefault(),this._moving(a)}},{key:"_onTouchMove",value:function(a){a.preventDefault&&a.preventDefault(),this._moving(a.touches[0])}},{key:"_onMouseUp",value:function(a){U(document).off(Lb,this._onMouseMove).off(Mb,this._onMouseUp),this._end(a,this.elements)}},{key:"_onTouchEnd",value:function(a){U(document).off(Nb,this._onTouchMove).off(Ob,this._onTouchEnd),0===a.touches.length&&this._end(a.changedTouches[0],this.elements)}},{key:"_emitEvent",value:function(){var a;(a=this.eventDispatcher).emit.apply(a,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"on",value:function(a,b){return this.eventDispatcher.addEventListener(a,b),this}},{key:"off",value:function(a,b){return this.eventDispatcher.removeEventListener(a,b),this}}]),a}(),Qb=function(){throw Error("Method not implemented")},Rb=Math.PI/180,Sb=180/Math.PI,Tb=function(a,b){return 0===b?a:Math.round(a/b)*b},Ub=function(a,b){if(0===b)return a;var c=Tb(a,b);return c-a<b?c:void 0},Vb=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return Number(a.toFixed(b))},Wb=function(a){for(var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,c=[],d=function(b){var d=a.map(function(a){return a[b]});c.push([Math.min.apply(Math,t(d)),Math.max.apply(Math,t(d))])},e=0;e<b;e++)d(e);return c},Xb=function(a){return a.getBoundingClientRect()},Yb=function(a,b){if(b){if(a.classList){if(!(b.indexOf(" ")>-1))return a.classList.add(b);b.split(/\s+/).forEach(function(b){return a.classList.add(b)})}return a}},Zb=function(a,b){if(b){if(a.classList){if(!(b.indexOf(" ")>-1))return a.classList.remove(b);b.split(/\s+/).forEach(function(b){return a.classList.remove(b)})}return a}},$b=function(a,b){var c=Xb(a),d=c.top,e=c.left,f=Xb(b),g=f.top,h=f.left,i=U(a),j=U(b);return!(d<g||d+parseFloat(i.css("height"))>g+parseFloat(j.css("height"))||e<h||e+parseFloat(i.css("width"))>h+parseFloat(j.css("width")))},_b=function(a){var b="matrix3d(".concat(a.join(),")");return{transform:b,webkitTranform:b,mozTransform:b,msTransform:b,otransform:b}},ac=function(a,b){var f,c=window.getComputedStyle(a),d=null,e=C(pb);try{for(e.s();!(f=e.n()).done;){var g=f.value;if(d=c.getPropertyValue("".concat(g).concat(b))||d)break}}catch(h){e.e(h)}finally{e.f()}return d},bc=function(){var a=document.documentElement;return{left:(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),top:(window.pageYOffset||a.scrollTop)-(a.clientTop||0)}},cc=function(a){for(var b=0,c=0;a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)b+=a.offsetLeft-a.scrollLeft,c+=a.offsetTop-a.scrollTop,a=a.offsetParent;return{left:b,top:c}},dc=wb.NOTIFIER_EVENTS,ec=wb.ON_GETSTATE,fc=wb.ON_APPLY,gc=wb.ON_MOVE,hc=wb.ON_RESIZE,ic=wb.ON_ROTATE,jc=xb.EMITTER_EVENTS,kc=xb.E_DRAG_START,lc=xb.E_DRAG,mc=xb.E_DRAG_END,nc=xb.E_RESIZE_START,oc=xb.E_RESIZE,pc=xb.E_RESIZE_END,qc=xb.E_ROTATE_START,rc=xb.E_ROTATE,sc=xb.E_ROTATE_END,tc=xb.E_SET_POINT,uc=xb.E_SET_POINT_END,vc=Bb.TRANSFORM_HANDLES_KEYS,wc=Bb.TRANSFORM_EDGES_KEYS,xc=yb.E_MOUSEDOWN,yc=yb.E_TOUCHSTART,zc=yb.E_MOUSEMOVE,Ac=yb.E_MOUSEUP,Bc=yb.E_TOUCHMOVE,Cc=yb.E_TOUCHEND,Dc=vc.TOP_LEFT,Ec=vc.TOP_CENTER,Fc=vc.TOP_RIGHT,Gc=vc.BOTTOM_LEFT,Hc=vc.BOTTOM_RIGHT,Ic=vc.BOTTOM_CENTER,Jc=vc.MIDDLE_LEFT,Kc=vc.MIDDLE_RIGHT,Lc=wc.TOP_EDGE,Mc=wc.BOTTOM_EDGE,Nc=wc.LEFT_EDGE,Oc=wc.RIGHT_EDGE,Pc=Object.keys,Qc=Object.values,Rc=function(c){function f(a,c,d){var g;if(b(this,f),g=e.call(this,a),g.constructor===f)throw new TypeError("Cannot construct Transformable instances directly");return g.observable=d,jc.forEach(function(a){return g.eventDispatcher.registerEvent(a)}),r(i(f.prototype),"enable",n(g)).call(n(g),c),g}h(f,c);var e=p(f);return d(f,[{key:"_cursorPoint",value:function(){throw Error("'_cursorPoint()' method not implemented")}},{key:"_rotate",value:function(a){var b=a.element,c=a.radians,d=m(a,["element","radians"]),e=this._processRotate(b,c),h=g({transform:e,delta:c},d);this.proxyMethods.onRotate.call(this,h),r(i(f.prototype),"_emitEvent",this).call(this,rc,h)}},{key:"_resize",value:function(a){var b=a.element,c=a.dx,d=a.dy,e=m(a,["element","dx","dy"]),h=this._processResize(b,{dx:c,dy:d}),j=g({},h,{dx:c,dy:d},e);this.proxyMethods.onResize.call(this,j),r(i(f.prototype),"_emitEvent",this).call(this,oc,j)}},{key:"_processOptions",value:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=this.elements;t(c).map(function(a){return Yb(a,"".concat(X,"drag"))});var d=b.each,e=void 0===d?{move:!1,resize:!1,rotate:!1}:d,f=b.snap,h=void 0===f?{x:10,y:10,angle:10}:f,i=b.axis,j=void 0===i?"xy":i,k=b.cursorMove,l=void 0===k?"auto":k,m=b.cursorResize,n=void 0===m?"auto":m,o=b.cursorRotate,p=void 0===o?"auto":o,q=b.rotationPoint,r=void 0===q?!1:q,s=b.transformOrigin,u=void 0===s?!1:s,v=b.restrict,w=b.draggable,x=void 0===w?!0:w,y=b.resizable,z=void 0===y?!0:y,A=b.rotatable,B=void 0===A?!0:A,C=b.scalable,D=void 0===C?!1:C,E=b.applyTranslate,F=void 0===E?!1:E,G=b.onInit,H=void 0===G?M:G,I=b.onDrop,J=void 0===I?M:I,K=b.onMove,L=void 0===K?M:K,N=b.onResize,O=void 0===N?M:N,P=b.onRotate,R=void 0===P?M:P,S=b.onDestroy,T=void 0===S?M:S,V=b.container,W=void 0===V?c[0].parentNode:V,Y=b.controlsContainer,Z=void 0===Y?W:Y,$=b.proportions,_=void 0===$?!1:$,ab=b.rotatorAnchor,bb=void 0===ab?null:ab,cb=b.rotatorOffset,db=void 0===cb?50:cb,eb=b.showNormal,fb=void 0===eb?!0:eb,gb=b.custom;this.options={axis:j,cursorMove:l,cursorRotate:p,cursorResize:n,rotationPoint:r,transformOrigin:u||r,restrict:v?U(v)[0]||document.body:null,container:U(W)[0],controlsContainer:U(Z)[0],snap:g({},h,{angle:h.angle*Rb}),each:e,proportions:_,draggable:x,resizable:z,rotatable:B,scalable:D,applyTranslate:F,custom:"object"===a(gb)&&gb||null,rotatorAnchor:bb,rotatorOffset:db,showNormal:fb,isGrouped:c.length>1},this.proxyMethods={onInit:Q(H),onDrop:Q(J),onMove:Q(L),onResize:Q(O),onRotate:Q(R),onDestroy:Q(T)},this.subscribe(e)}},{key:"_animate",value:function(){var a=this,b=this,c=b.observable,d=b.storage,e=b.options,h=b.elements;if(!O(d)&&(d.frame=D(b._animate),d.doDraw)){d.doDraw=!1;var j=d.dox,k=d.doy,l=d.clientX,m=d.clientY,n=d.relativeX,o=d.relativeY,p=d.doDrag,q=d.doResize,s=d.doRotate,t=d.doSetCenter,u=d.revX,v=d.revY,w=d.mouseEvent,x=d.data,y=e.snap,z=e.each,A=z.move,B=z.resize,C=z.rotate,E=e.draggable,F=e.resizable,G=e.rotatable,H=e.isGrouped,I=e.restrict;if(q&&F){var J=Ub(l-n,y.x),K=Ub(m-o,y.y),L=d.cached,M=d.cached;M=void 0===M?{}:M;var N=M.dist;N=void 0===N?{}:N;var P=N.dx,Q=void 0===P?J:P,R=N.dy,S=void 0===R?K:R,T={dx:J,dy:K,clientX:l,clientY:m,mouseEvent:w},U=I?h.reduce(function(b,c){var d=x.get(c),e=d.transform.ctm,f=H?{x:J,y:K}:a._pointToTransform({x:J,y:K,matrix:e}),g=f.x,h=f.y,i=j?u?-g:g:0,l=k?v?-h:h:0,m=a._processResizeRestrict(c,{dx:i,dy:l}),n=m.x,o=m.y;return{x:null!==n&&null===b.x?J:b.x,y:null!==o&&null===b.y?K:b.y}},{x:null,y:null}):{x:null,y:null},V=U.x,W=U.y,X=I&&(null!==V||null!==W),Y=X?Q:J,Z=X?S:K,$=g({},T,{dx:Y,dy:Z,revX:u,revY:v,dox:j,doy:k});h.map(function(c){var d=x.get(c),e=d.transform.ctm,f=H?{x:Y,y:Z}:a._pointToTransform({x:Y,y:Z,matrix:e}),h=f.x,i=f.y,l=j?u?-h:h:0,m=k?v?-i:i:0;b._resize(g({},$,{element:c,dx:l,dy:m}))}),this.storage.cached=g({},L,{dist:{dx:Y,dy:Z}}),this._processControlsResize({dx:Y,dy:Z}),B&&c.notify(hc,b,$)}if(p&&E){var _=j?Ub(l-n,y.x):0,ab=k?Ub(m-o,y.y):0,bb=d.cached,cb=d.cached;cb=void 0===cb?{}:cb;var db=cb.dist;db=void 0===db?{}:db;var eb=db.dx,fb=void 0===eb?_:eb,gb=db.dy,hb=void 0===gb?ab:gb,ib={dx:_,dy:ab,clientX:l,clientY:m,mouseEvent:w},jb=I?h.reduce(function(b,c){var d=a._processMoveRestrict(c,ib),e=d.x,f=d.y;return{x:null===b.x&&I?e:b.x,y:null===b.y&&I?f:b.y}},{x:null,y:null}):{x:null,y:null},kb=jb.x,lb=jb.y,mb=null!==kb&&I?fb:_,nb=null!==lb&&I?hb:ab,ob=g({},ib,{dx:mb,dy:nb});this.storage.cached=g({},bb,{dist:{dx:mb,dy:nb}}),h.map(function(b){return r(i(f.prototype),"_drag",a).call(a,g({element:b},ob,{dx:mb,dy:nb}))}),this._processControlsMove({dx:mb,dy:nb}),A&&c.notify(gc,b,ob)}if(s&&G){var pb=d.pressang,qb=d.center,rb=Math.atan2(m-qb.y,l-qb.x),sb=Ub(rb-pb,y.angle);if(I){var tb=h.some(function(b){var c=a._processRotateRestrict(b,sb),d=c.x,e=c.y;return null!==d||null!==e});if(tb)return}var ub={clientX:l,clientY:m,mouseEvent:w};h.map(function(a){return b._rotate(g({element:a,radians:sb},ub))}),this._processControlsRotate({radians:sb}),C&&c.notify(ic,b,g({radians:sb},ub))}if(t&&G){var vb=d.bx,wb=d.by,xb=this._pointToControls({x:l,y:m}),yb=xb.x,zb=xb.y;b._moveCenterHandle(yb-vb,zb-wb)}}}},{key:"_start",value:function(a){var b=a.clientX,c=a.clientY,d=this.elements,e=this.observable,h=this.options,j=h.axis,k=h.each,l=this.storage,m=this.storage.handles,n=Qc(m).some(function(b){return U(a.target).is(b)})||d.some(function(b){return b.contains(a.target)});if(l.isTarget=n,n){var o=this._compute(a,d);Pc(o).map(function(a){return l[a]=o[a]});var p=o.onRightEdge,q=o.onBottomEdge,s=o.onTopEdge,t=o.onLeftEdge,u=o.handle,v=o.factor,w=o.revX,x=o.revY,y=o.doW,z=o.doH,A=p||q||s||t,B=m.rotator,C=m.center,D=m.radius;N(D)&&Zb(D,"".concat(X,"hidden"));var E=u.is(B),F=N(C)?u.is(C):!1,G=n&&!(E||A||F),H={mouseEvent:a,clientX:b,clientY:c,doResize:A,doDrag:G,doRotate:E,doSetCenter:F,onExecution:!0,cursor:null,dox:/\x/.test(j)&&(A?u.is(m.ml)||u.is(m.mr)||u.is(m.tl)||u.is(m.tr)||u.is(m.bl)||u.is(m.br)||u.is(m.le)||u.is(m.re):!0),doy:/\y/.test(j)&&(A?u.is(m.br)||u.is(m.bl)||u.is(m.bc)||u.is(m.tr)||u.is(m.tl)||u.is(m.tc)||u.is(m.te)||u.is(m.be):!0)};this.storage=g({},l,{},H);var I={clientX:b,clientY:c};A?(r(i(f.prototype),"_emitEvent",this).call(this,nc,I),jxStart()):E?(r(i(f.prototype),"_emitEvent",this).call(this,qc,I),jxStart()):G&&(r(i(f.prototype),"_emitEvent",this).call(this,kc,I),jxStart());var J=k.move,K=k.resize,L=k.rotate,M=A?oc:E?rc:lc,O=A&&K||E&&L||G&&J;e.notify(ec,this,{clientX:b,clientY:c,actionName:M,triggerEvent:O,factor:v,revX:w,revY:x,doW:y,doH:z}),this._draw()}}},{key:"_moving",value:function(a){var b=this.storage,c=void 0===b?{}:b,d=this.options;if(c.isTarget){var e=this._cursorPoint(a),f=e.x,g=e.y;c.mouseEvent=a,c.clientX=f,c.clientY=g,c.doDraw=!0;var h=c.doRotate,i=c.doDrag,j=c.doResize,k=c.cursor,l=d.cursorMove,m=d.cursorResize,n=d.cursorRotate;O(k)&&(i?k=l:h?k=n:j&&(k=m),U(document.body).css({cursor:k}))}}},{key:"_end",value:function(a){var b=this,c=a.clientX,d=a.clientY,e=this.elements,g=this.options.each,h=this.observable,j=this.storage,k=j.doResize,l=j.doDrag,m=j.doRotate,n=j.doSetCenter,o=j.frame,p=j.handles.radius,q=j.isTarget,s=this.proxyMethods;if(q){var t=[{actionName:oc,condition:k},{actionName:lc,condition:l},{actionName:rc,condition:m},{actionName:tc,condition:n}].find(function(a){var b=a.condition;return b})||{},u=t.actionName,v=void 0===u?lc:u;e.map(function(a){return b._applyTransformToElement(a,v)}),this._processActions(v),this._updateStorage();var w={clientX:c,clientY:d};s.onDrop.call(this,w),k?(r(i(f.prototype),"_emitEvent",this).call(this,pc,w),jxEnd("resize")):m?(r(i(f.prototype),"_emitEvent",this).call(this,sc,w),jxEnd("rotate")):l?(r(i(f.prototype),"_emitEvent",this).call(this,mc,w),jxEnd("drag")):n&&r(i(f.prototype),"_emitEvent",this).call(this,uc,w);var x=g.move,y=g.resize,z=g.rotate,A=k&&y||m&&z||l&&x;h.notify(fc,this,{clientX:c,clientY:d,actionName:v,triggerEvent:A}),E(o),U(document.body).css({cursor:"auto"}),N(p)&&Yb(p,"".concat(X,"hidden"))}}},{key:"_compute",value:function(a,b){var c=this,d=this.storage;d=void 0===d?{}:d;var e=d.handles,f=d.data,h=U(a.target),i=this._checkHandles(h,e),j=i.revX,k=i.revY,l=i.doW,n=i.doH,o=m(i,["revX","revY","doW","doH"]),p=this._getCommonState(),q=this._cursorPoint(a),r=q.x,s=q.y,t=this._pointToControls({x:r,y:s},p.transform),u=t.x,v=t.y;b.map(function(a){var b=c._getElementState(a,{revX:j,revY:k,doW:l,doH:n}),d=b.transform,e=m(b,["transform"]),h=c._pointToTransform({x:r,y:s,matrix:d.ctm}),i=h.x,o=h.y;f.set(a,g({},f.get(a),{},e,{transform:d,cx:i,cy:o}))});var w=Math.atan2(s-p.center.y,r-p.center.x);return g({data:f},o,{handle:Qc(e).some(function(b){return U(a.target).is(b)})?h:U(b[0]),pressang:w},p,{revX:j,revY:k,doW:l,doH:n,relativeX:r,relativeY:s,bx:u,by:v})}},{key:"_checkHandles",value:function(a,b){var c=function(b){return N(b)?a.is(b):!1},d=function(a){return a.some(function(a){return c(b[a])})},e=d([Dc,Jc,Gc,Ec,Nc]),f=d([Dc,Fc,Ec,Jc,Lc]),g=d([Ec,Fc,Dc,Lc]),h=d([Dc,Jc,Gc,Nc]),i=d([Fc,Kc,Hc,Oc]),j=d([Hc,Ic,Gc,Mc]),k=d([Jc,Kc,Nc,Oc]),l=d([Ec,Ic,Mc,Lc]);return{revX:e,revY:f,onTopEdge:g,onLeftEdge:h,onRightEdge:i,onBottomEdge:j,doW:k,doH:l}}},{key:"_restrictHandler",value:function(a,b){for(var c=null,d=null,e=this.getBoundingRect(a,b),f=this._getRestrictedBBox(),g=Wb(f),h=s(g,2),i=s(h[0],2),j=i[0],k=i[1],l=s(h[1],2),m=l[0],n=l[1],o=0,p=e.length;o<p;o++){var q=s(e[o],2),r=q[0],t=q[1];(r<j||r>k)&&(c=r),(t<m||t>n)&&(d=t)}return{x:c,y:d}}},{key:"_destroy",value:function(){var a=this,b=this.elements,c=this.storage;c=void 0===c?{}:c;var d=c.controls,e=c.wrapper;[].concat(t(b),[d]).map(function(b){return U(b).off(xc,a._onMouseDown).off(yc,a._onTouchStart)}),e.parentNode.removeChild(e)}},{key:"_updateStorage",value:function(){var a=this.storage,b=this.storage,c=b.transformOrigin,d=b.transform;d=void 0===d?{}:d;var e=d.controlsMatrix,f=b.cached;f=void 0===f?{}:f;var h=f.transformOrigin,i=void 0===h?c:h,j=f.controlsMatrix,k=void 0===j?e:j;this.storage=g({},a,{doResize:!1,doDrag:!1,doRotate:!1,doSetCenter:!1,doDraw:!1,onExecution:!1,cursor:null,transformOrigin:i,controlsMatrix:k,cached:{}})}},{key:"notifyMove",value:function(a){var b=this,c=a.dx,d=a.dy;this.elements.map(function(a){return r(i(f.prototype),"_drag",b).call(b,{element:a,dx:c,dy:d})}),this._processControlsMove({dx:c,dy:d})}},{key:"notifyRotate",value:function(a){var b=this,c=a.radians,d=m(a,["radians"]),e=this.elements,f=this.options;f=void 0===f?{}:f;var h=f.snap.angle;e.map(function(a){return b._rotate(g({element:a,radians:Ub(c,h)},d))}),this._processControlsRotate({radians:c})}},{key:"notifyResize",value:function(a){var b=this,c=a.dx,d=a.dy,e=a.revX,f=a.revY,g=a.dox,h=a.doy,i=this.elements,j=this.storage.data,k=this.options.isGrouped;i.map(function(a){var i=j.get(a),l=i.transform.ctm,m=k?{x:c,y:d}:b._pointToTransform({x:c,y:d,matrix:l}),n=m.x,o=m.y;b._resize({element:a,dx:g?e?-n:n:0,dy:h?f?-o:o:0})}),this._processControlsResize({dx:c,dy:d})}},{key:"notifyApply",value:function(a){var b=this,c=a.clientX,d=a.clientY,e=a.actionName,g=a.triggerEvent;this.proxyMethods.onDrop.call(this,{clientX:c,clientY:d}),g&&(this.elements.map(function(a){return b._applyTransformToElement(a,e)}),r(i(f.prototype),"_emitEvent",this).call(this,"".concat(e,"End"),{clientX:c,clientY:d}))}},{key:"notifyGetState",value:function(a){var b=this,c=a.clientX,d=a.clientY,e=a.actionName,h=a.triggerEvent,j=m(a,["clientX","clientY","actionName","triggerEvent"]);if(h){var k=this.elements,l=this.storage.data;k.map(function(a){var c=b._getElementState(a,j);l.set(a,g({},l.get(a),{},c))});var n=this._getCommonState();this.storage=g({},this.storage,{},n),r(i(f.prototype),"_emitEvent",this).call(this,"".concat(e,"Start"),{clientX:c,clientY:d})}}},{key:"subscribe",value:function(a){var b=a.resize,c=a.move,d=a.rotate,e=this.observable;(c||b||d)&&e.subscribe(ec,this).subscribe(fc,this),c&&e.subscribe(gc,this),b&&e.subscribe(hc,this),d&&e.subscribe(ic,this)}},{key:"unsubscribe",value:function(){var a=this,b=this.observable;dc.map(function(c){return b.unsubscribe(c,a)})}},{key:"disable",value:function(){var a=this.storage,b=this.proxyMethods,c=this.elements;O(a)||(a.onExecution&&U(document).off(zc,this._onMouseMove).off(Ac,this._onMouseUp).off(Bc,this._onTouchMove).off(Cc,this._onTouchEnd),c.map(function(a){return Zb(a,"".concat(X,"drag"))}),this.unsubscribe(),this._destroy(),b.onDestroy.call(this,c),delete this.storage)}},{key:"exeDrag",value:function(a){var b=this,c=a.dx,d=a.dy,e=this.elements,h=this.options.draggable,j=this.storage,k=this.storage.data;if(h){var l=this._getCommonState();e.map(function(a){var c=b._getElementState(a,{revX:!1,revY:!1,doW:!1,doH:!1});k.set(a,g({},k.get(a),{},c))}),this.storage=g({},j,{},l),e.map(function(a){r(i(f.prototype),"_drag",b).call(b,{element:a,dx:c,dy:d}),b._applyTransformToElement(a,lc)}),this._processControlsMove({dx:c,dy:d})}}},{key:"exeResize",value:function(a){var b=this,c=a.dx,d=a.dy,e=a.revX,f=void 0===e?!1:e,h=a.revY,i=void 0===h?!1:h,j=a.doW,k=void 0===j?!1:j,l=a.doH,m=void 0===l?!1:l,n=this.elements,o=this.options.resizable,p=this.storage,q=this.storage.data;if(o){var r=this._getCommonState();n.map(function(a){var c=b._getElementState(a,{revX:f,revY:i,doW:k,doH:m});q.set(a,g({},q.get(a),{},c))}),this.storage=g({},p,{},r),n.map(function(a){b._resize({element:a,dx:c,dy:d}),b._applyTransformToElement(a,oc)}),this._processControlsMove({dx:c,dy:d})}}},{key:"exeRotate",value:function(a){var b=this,c=a.delta,d=this.elements,e=this.options.rotatable,f=this.storage,h=this.storage.data;if(e){var i=this._getCommonState();d.map(function(a){var c=b._getElementState(a,{revX:!1,revY:!1,doW:!1,doH:!1});h.set(a,g({},h.get(a),{},c))}),this.storage=g({},f,{},i),d.map(function(a){b._rotate({element:a,radians:c}),b._applyTransformToElement(a,rc)}),this._processControlsRotate({radians:c})}}},{key:"setCenterPoint",value:function(){throw Error("'setCenterPoint()' method not implemented")}},{key:"resetCenterPoint",value:function(){L('"resetCenterPoint" method is replaced by "resetTransformOrigin" and would be removed soon'),this.setTransformOrigin({dx:0,dy:0},!1)}},{key:"setTransformOrigin",value:function(){throw Error("'setTransformOrigin()' method not implemented")}},{key:"resetTransformOrigin",value:function(){this.setTransformOrigin({dx:0,dy:0},!1)}},{key:"controls",get:function(){return this.storage.wrapper}}]),f}(Pb),Sc=function(a){return a.map(function(a){return t(a)})},Tc=function(a){return a.reduce(function(b,c,d){return[].concat(t(b),[a[0][d],a[1][d],a[2][d],a[3][d]])},[])},Uc=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;return t(Array(a)).map(function(a,b,c){return c.map(function(){return+!b--})})},Vc=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Uc().map(function(d,e){return d[3]=[a,b,c,1][e],d})},Wc=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Uc().map(function(e,f){return e[f]=[a,b,c,d][f],e})},Xc=function(a,b){var c=Uc();return c[0][0]=b,c[0][1]=-a,c[1][0]=a,c[1][1]=b,c},Yc=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,c=b?Sc(a):a;return c[0][3]=c[1][3]=c[2][3]=0,c},Zc=function(a,b){for(var c=[],d=0,e=a.length;d<e;++d){for(var f=0,g=0;g<e;++g)f+=+a[d][g]*b[g];c[d]=f}return c},$c=function(a,b){for(var c=[],d=0;d<b.length;d++){c[d]=[];for(var e=0;e<a[0].length;e++){for(var f=0,g=0;g<a.length;g++)f+=a[g][e]*b[d][g];c[d].push(f)}}return c},_c=function(a){for(var c,b=Sc(a),d=b.length,e=[],f=0;f<d;f++)e[f]=[];for(var g=0;g<d;g++)for(var h=0;h<d;h++)e[g][h]=0,g==h&&(e[g][h]=1);for(var i=0;i<d;i++){c=b[i][i];for(var j=0;j<d;j++)b[i][j]/=c,e[i][j]/=c;
for(var k=i+1;k<d;k++){c=b[k][i];for(var l=0;l<d;l++)b[k][l]-=b[i][l]*c,e[k][l]-=e[i][l]*c}}for(var m=d-1;m>0;m--)for(var n=m-1;n>=0;n--){c=b[n][m];for(var o=0;o<d;o++)b[n][o]-=b[m][o]*c,e[n][o]-=e[m][o]*c}for(var p=0;p<d;p++)for(var q=0;q<d;q++)b[p][q]=e[p][q];return b},ad=function(a,b){var c=s(b,3),d=c[0],e=c[1],f=c[2],g=Vc(-d,-e,-f),h=Vc(d,e,f);return $c($c(g,a),h)},bd=function(a){for(var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,c=arguments.length>2?arguments[2]:void 0,d=Uc(),e=a,f=c||dd(e),g=!1;e&&e instanceof Element;){var h=ed(e,g);if(d=$c(d,ad(f,h)),g=!0,e===b||null===e.offsetParent)break;e=e.offsetParent,f=dd(e)}return d},cd=function(a){var b=Math.sqrt(a[0][0]*a[0][0]+a[1][0]*a[1][0]+a[2][0]*a[2][0]),c=Math.sqrt(a[0][1]*a[0][1]+a[1][1]*a[1][1]+a[2][1]*a[2][1]),d=Math.sqrt(a[0][2]*a[0][2]+a[1][2]*a[1][2]+a[2][2]*a[2][2]),e=Math.atan2(-a[0][3]/d,a[1][3]/d),f=Math.asin(a[3][1]/d),g=Math.atan2(-a[3][0]/c,a[0][0]/b);return(1===a[0][1]||-1===a[0][1])&&(e=0,f=a[0][1]*-Math.PI/2,g=a[0][1]*Math.atan2(a[1][1]/c,a[0][1]/c)),{rotate:{x:e,y:f,z:g},translate:{x:a[0][3]/b,y:a[1][3]/c,z:a[2][3]/d},scale:{sX:b,sY:c,sZ:d}}},dd=function(a){var b=ac(a,"transform")||"none",c=Uc();if("none"===b)return c;var d=b.split(/\s*[(),]\s*/).slice(1,-1);if(16!==d.length)return[[+d[0],+d[2],0,+d[4]],[+d[1],+d[3],0,+d[5]],[0,0,1,0],[0,0,0,1]];for(var e=0;e<4;++e)for(var f=0;f<4;++f)c[f][e]=+d[4*e+f];return c},ed=function(a,b){for(var c=ac(a,"transform-origin"),d=c?c.split(" "):[],e=[b?-a.clientLeft:0,b?-a.clientTop:0,0,1],f=0;f<d.length;++f)e[f]+=parseFloat(d[f]);return e},fd=function(a){for(var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,c=0,d=0,e=a,f=!1;e&&e.offsetParent;){var g=bd(e.offsetParent),h=Zc(Yc(g,!1),[e.offsetLeft+(f?e.clientLeft:0),e.offsetTop+(f?e.clientTop:0),0,1]),i=s(h,2),j=i[0],k=i[1];if(d+=j,c+=k,b===e)break;f=!0,e=e.offsetParent}return[d,c,0,1]},gd=yb.E_MOUSEDOWN,hd=yb.E_TOUCHSTART,id=Object.keys,jd=Object.entries,kd=Object.values,ld=function(a){function e(){return b(this,e),c.apply(this,arguments)}h(e,a);var c=p(e);return d(e,[{key:"_init",value:function(a){var b=this,c=this.options,d=c.transformOrigin,e=c.container,f=c.controlsContainer,h=c.resizable,i=c.rotatable,j=c.showNormal,k=c.restrict,l=qd(["sjx-wrapper"]),n=qd(["sjx-controls"]),o={},p=this._getVertices(),q=p.rotator,r=void 0===q?null:q,s=p.anchor,u=void 0===s?null:s,v=m(p,["rotator","anchor"]),w={};if(i){var x=j?nd([[u.x,u.y],r],"normal"):null;j&&n.appendChild(x);var y=null;d&&(y=nd([v.center,v.center],"radius"),Yb(y,"sjx-hidden"),n.appendChild(y)),w=g({},w,{normal:x,radius:y})}var z={te:[v.tl,v.tr],be:[v.bl,v.br],le:[v.tl,v.bl],re:[v.tr,v.br]},A=h?{tl:v.tl,tr:v.tr,br:v.br,bl:v.bl,tc:v.tc,bc:v.bc,ml:v.ml,mr:v.mr}:{},B=Array.isArray(d)?[].concat(t(d),[0,1]):v.center,C=g({},A,{center:d&&i?B:void 0,rotator:r}),D=function(a,b){return id(a).map(function(c){var d=a[c];if(!O(d)){var e=b(d,c);o[c]=e,n.appendChild(e)}})};D(z,nd),D(C,md),l.appendChild(n),f.appendChild(l);var E=new WeakMap;a.map(function(a){return E.set(a,{parent:a.parentNode,transform:{ctm:bd(a,e)},bBox:b._getBBox(),__data__:new WeakMap,cached:{}})});var F=k||e;this.storage={wrapper:l,controls:n,handles:g({},o,{},w),data:E,center:{isShifted:Array.isArray(d)},transformOrigin:B,transform:{containerMatrix:bd(F,F.parentNode)},cached:{}},[].concat(t(a),[n]).map(function(a){return U(a).on(gd,b._onMouseDown).on(hd,b._onTouchStart)})}},{key:"_pointToTransform",value:function(a){var b=a.x,c=a.y,d=a.matrix,e=_c(d);return this._applyMatrixToPoint(Yc(e,!1),b,c)}},{key:"_pointToControls",value:function(a){var b=a.x,c=a.y,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.transform,e=d.controlsMatrix,f=_c(e);return this._applyMatrixToPoint(Yc(f,!1),b,c)}},{key:"_applyMatrixToPoint",value:function(a,b,c){var d=Zc(a,[b,c,0,1]),e=s(d,2),f=e[0],g=e[1];return{x:f,y:g}}},{key:"_cursorPoint",value:function(a){var b=a.clientX,c=a.clientY,d=this.options.container,e=bd(d),f=cc(d),g=bc(),h=g.left,i=g.top,j=Vc(f.left-h,f.top-i);return this._applyMatrixToPoint(_c($c(e,j)),b,c)}},{key:"_getRestrictedBBox",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,b=this.storage.transform.containerMatrix,c=this.options,d=c.restrict,e=c.container,f=d||e;return pd(f,e,a?bd(f,e):b)}},{key:"_applyTransformToElement",value:function(a){var b=this.storage,c=b.controls,d=b.data,e=this.options.applyTranslate,f=d.get(a),g=f.cached,h=f.transform.matrix,i=U(c);if(!O(g)&&e){var j=U(a),k=g.dx,l=g.dy,m=_b(h),n=parseFloat(a.style.left||j.css("left")),o=parseFloat(a.style.top||j.css("top"));m.left="".concat(n+k,"px"),m.top="".concat(o+l,"px"),j.css(m),i.css(m)}}},{key:"_processActions",value:function(){}},{key:"_processResize",value:function(a,b){var c=b.dx,d=b.dy,e=this.storage,f=e.revX,h=e.revY,i=e.doW,j=e.doH,k=e.data,l=e.bBox,m=l.width,n=l.height,o=this.options,p=o.proportions,q=o.scalable,r=k.get(a),t=r.transform,u=t.matrix,v=t.auxiliary.scale.translateMatrix,w=r.cached,x=function(a,b){var c=i||!i&&!j?(m+a)/m:(n+b)/n,d=p?m*c:m+a,e=p?n*c:n+b,f=d/m,g=e/n;return[f,g,d,e]},y=function(a,b){var c=Wc(a,b);return $c($c(v,c),_c(v))},z=function(a,b){var c=a[0][3],d=a[1][3],e=Vc(c,d),g=Vc(c*(f?-1:1),d*(h?-1:1));return $c($c(g,b),_c(e))},A=x(c,d),B=s(A,4),C=B[0],D=B[1],E=B[2],F=B[3],G=y(C,D),H=q?$c(G,u):z(G,u);return E<=V||F<=V?{transform:H,width:E,height:F}:(this._updateElementView(a,g({},_b(Tc(H)),{},!q&&{width:"".concat(E,"px"),height:"".concat(F,"px")})),k.set(a,g({},r,{cached:g({},w,{dx:c,dy:d,bBox:{width:E,height:F}})})),{transform:H,width:E,height:F})}},{key:"_processMove",value:function(a,b){var c=b.dx,d=b.dy,e=this.storage.data,f=e.get(a),h=f.transform,i=h.matrix,j=h.auxiliary.translate.parentMatrix,k=f.cached,l=void 0===k?{}:k,m=Zc(j,[c,d,0,1]),n=s(m,2),o=n[0],p=n[1],q=$c(i,Vc(o,p)),r=_b(Tc(q));return this._updateElementView(a,r),e.set(a,g({},f,{cached:g({},l,{dist:{dx:Vb(c),dy:Vb(d),ox:Vb(o),oy:Vb(p)}})})),q}},{key:"_processRotate",value:function(a,b){var c=this.storage.data,d=this.options.restrict,e=c.get(a),f=e.transform,g=f.matrix,h=f.auxiliary.rotate.translateMatrix,i=Vb(Math.cos(b),4),j=Vb(Math.sin(b),4),k=Xc(j,i),l=$c($c(_c(h),k),h),m=$c(g,l),n=d?this._restrictHandler(m):{x:null,y:null},o=n.x,p=n.y;return N(o)||N(p)?m:(this._updateElementView(a,_b(Tc(m))),m)}},{key:"_getElementState",value:function(a,b){var c=b.revX,d=b.revY,e=b.doW,f=b.doH,g=this.storage,h=g.handles.center,i=g.data,j=g.transformOrigin,k=this.options,l=k.container,m=k.scalable,n=i.get(a),o=n.parent,p=fd(a,l),q=s(p,2),r=q[0],t=q[1],u=a.offsetLeft,v=a.offsetTop,w=a.offsetWidth,x=a.offsetHeight,y=dd(a),z=bd(a,l),A=bd(o,l),B=w/2,C=x/2,D=Zc(z,[B,C,0,1]),E=s(D,2),F=E[0],G=E[1],H=f?0:c?-B:B,I=e?0:d?-C:C,J=F+r,K=G+t,L=h?dd(h):Uc(),M=Zc($c(_c(Yc(z)),Yc(L)),[j[0]-J,j[1]-K,0,1]),N=s(M,2),O=N[0],P=N[1],Q=Zc(y,[O,P,0,1]),R=s(Q,2),S=R[0],T=R[1],U=cd(bd(a,a.parentNode)),V=U.scale,W=V.sX,X=V.sY,Y={auxiliary:{scale:{translateMatrix:m?Vc(H,I):Vc(f?0:B,e?0:C)},translate:{parentMatrix:_c(Yc(A))},rotate:{translateMatrix:Vc(S,T)}},scaleX:H,scaleY:I,matrix:y,ctm:z,parentMatrix:A,scX:W,scY:X};return{transform:Y,bBox:{width:w,height:x,left:u,top:v,offset:{left:r,top:t}}}}},{key:"_getCommonState",value:function(){var a=this.elements,b=this.storage,c=b.controls,d=b.handles.center,e=b.center,f=b.wrapper,h=this.options,i=h.container,j=h.restrict,k=fd(a[0],i),l=s(k,2),m=l[0],n=l[1],o=bd(a[0],i),p=j||i,q=bd(p,p.parentNode),r=this._getBBox(),t=r.width,u=r.height,v=Zc(o,[t/2,u/2,0,1]),w=s(v,2),x=w[0],y=w[1],z=x+m,A=y+n,B=d?dd(d):Uc();return{transform:{controlsMatrix:bd(c,c.parentNode),containerMatrix:q,wrapperMatrix:bd(f,i)},bBox:g({},this._getBBox()),center:g({},e,{x:z,y:A,matrix:B})}}},{key:"_getBBox",value:function(){var a=s(this.elements,1),b=a[0],c=this.options,d=c.isGrouped,e=c.container;if(d)return this._getGroupBbox();var f=fd(b,e),g=s(f,2),h=g[0],i=g[1],j=b.offsetLeft,k=b.offsetTop,l=b.offsetWidth,m=b.offsetHeight;return{x:j,y:k,width:l,height:m,offset:{left:h,top:i}}}},{key:"_processControlsResize",value:function(){var a=this._applyTransformToHandles(),b=a.center,c=this.storage.transform.controlsMatrix;b&&(this.storage=g({},this.storage,{cached:{transformOrigin:Zc(c,b)}}))}},{key:"_processControlsMove",value:function(a){var b=a.dx,c=a.dy,d=this.storage,e=d.transform,f=e.controlsMatrix,h=e.wrapperMatrix,i=d.center,j=d.transformOrigin,k=$c(f,Vc(b,c));this._updateControlsView(k);var l=Yc(_c(h)),m=Zc(l,[b,c,0,1]),n=s(m,2),o=n[0],p=n[1];if(i.isShifted)this._moveCenterHandle(-o,-p,!1);else{var q=Vc(o,p);this.storage=g({},this.storage,{cached:{transformOrigin:Zc(q,j)}})}}},{key:"_processControlsRotate",value:function(){this._applyTransformToHandles()}},{key:"_moveCenterHandle",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0,d=this.storage,e=d.handles.center,f=d.center.matrix,h=d.center,i=d.transformOrigin,j=Vc(a,b),k=$c(f,j);U(e).css(g({},_b(Tc(k)))),this.storage=g({},this.storage,{center:g({},h,{isShifted:!0})},c?{cached:{transformOrigin:Zc(j,i)}}:{})}},{key:"_processMoveRestrict",value:function(a,b){var c=b.dx,d=b.dy,e=this.storage.data,f=e.get(a),g=f.transform,h=g.matrix,i=g.auxiliary.translate.parentMatrix,j=Zc(i,[c,d,0,1]),k=s(j,2),l=k[0],m=k[1],n=$c(h,Vc(l,m));return this._restrictHandler(n)}},{key:"_processRotateRestrict",value:function(a,b){var c=this.storage.data,d=c.get(a),e=d.transform,f=e.matrix,g=e.auxiliary.rotate.translateMatrix,h=Vb(Math.cos(b),4),i=Vb(Math.sin(b),4),j=Xc(i,h),k=$c($c(_c(g),j),g),l=$c(f,k);return this._restrictHandler(l)}},{key:"_processResizeRestrict",value:function(a,b){var c=b.dx,d=b.dy,e=this.storage,f=e.revX,g=e.revY,h=e.doW,i=e.doH,j=e.data,k=e.bBox,l=k.width,m=k.height,n=this.options,o=n.proportions,p=n.scalable,q=j.get(a),r=q.transform,t=r.matrix,u=r.auxiliary.scale.translateMatrix,v=function(a,b){var c=h||!h&&!i?(l+a)/l:(m+b)/m,d=o?l*c:l+a,e=o?m*c:m+b,f=d/l,g=e/m;return[f,g,d,e]},w=function(a,b){var c=Wc(a,b);return $c($c(u,c),_c(u))},x=function(a,b){var c=a[0][3],d=a[1][3],e=Vc(c,d),h=Vc(c*(f?-1:1),d*(g?-1:1));return $c($c(h,b),_c(e))},y=v(c,d),z=s(y,2),A=z[0],B=z[1],C=w(A,B),D=p?$c(C,t):x(C,t);return this._restrictHandler(D)}},{key:"_updateElementView",value:function(a,b){U(a).css(b)}},{key:"_updateControlsView",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Uc(),b=_b(Tc(a));U(this.storage.controls).css(b),this.storage.cached.controlsMatrix=a}},{key:"_getVertices",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Uc(),b=this.elements;b=void 0===b?[]:b;var c=s(b,1),d=c[0],e=this.options,f=e.isGrouped,g=e.rotatable,h=e.rotatorAnchor,i=e.rotatorOffset,j=f?this._getGroupVertices():this._getElementVertices(d,a),k=null;if(g){var l={},m=1;switch(h){case"n":l.x=j.tc[0],l.y=j.tc[1];break;case"s":l.x=j.bc[0],l.y=j.bc[1],m=-1;break;case"w":l.x=j.ml[0],l.y=j.ml[1],m=-1;break;case"e":default:l.x=j.mr[0],l.y=j.mr[1]}var n="n"===h||"s"===h?Math.atan2(j.bl[1]-j.tl[1],j.bl[0]-j.tl[0]):Math.atan2(j.tl[1]-j.tr[1],j.tl[0]-j.tr[0]);k=[l.x-i*m*Math.cos(n),l.y-i*m*Math.sin(n)],j.rotator=k,j.anchor=l}return j}},{key:"_getElementVertices",value:function(a,b){var c=this.options,d=c.container,e=c.isGrouped,f=fd(a,d),g=s(f,2),h=g[0],i=g[1],j=a.offsetWidth,k=a.offsetHeight,l={tl:[0,0,0,1],bl:[0,k,0,1],br:[j,k,0,1],tr:[j,0,0,1],tc:[j/2,0,0,1],ml:[0,k/2,0,1],bc:[j/2,k,0,1],mr:[j,k/2,0,1],center:[j/2,k/2,0,1]},m=e?b:$c(bd(a,d),b);return jd(l).reduce(function(a,b){var c=s(b,2),d=c[0],e=c[1];return[].concat(t(a),[[d,Zc(m,e)]])},[]).reduce(function(a,b){var c=s(b,2),d=c[0],e=s(c[1],4),f=e[0],g=e[1],j=e[2],k=e[3];return a[d]=[f+h,g+i,j,k],a},{})}},{key:"_getGroupVertices",value:function(){var a=this._getGroupBbox(),b=a.x,c=a.y,d=a.width,e=a.height,f=d/2,g=e/2;return{tl:[b,c],tr:[b+d,c],mr:[b+d,c+g],ml:[b,c+g],tc:[b+f,c],bc:[b+f,c+e],br:[b+d,c+e],bl:[b,c+e],center:[b+f,c+g]}}},{key:"_getGroupBbox",value:function(){var a=this.elements,b=this.options.container,c=a.reduce(function(a,c){var d=fd(c,b),e=s(d,2),f=e[0],g=e[1],h=c.offsetWidth,i=c.offsetHeight,j=[[0,0,0,1],[0,i,0,1],[h,i,0,1],[h,0,0,1]],k=bd(c,b),l=j.reduce(function(a,b){return[].concat(t(a),[Zc(k,b)])},[]).map(function(a){var b=s(a,4),c=b[0],d=b[1],e=b[2],h=b[3];return[c+f,d+g,e,h]});return[].concat(t(a),[l])},[]),d=Wb(c.reduce(function(a,b){return[].concat(t(a),t(b))},[])),e=s(d,2),f=s(e[0],2),g=f[0],h=f[1],i=s(e[1],2),j=i[0],k=i[1];return{x:g,y:j,width:h-g,height:k-j}}},{key:"_getElementBBox",value:function(a){var b=this.options.container,c=fd(a,b),d=s(c,2),e=d[0],f=d[1],g=a.offsetWidth,h=a.offsetHeight,i=[[0,0,0,1],[0,h,0,1],[g,h,0,1],[g,0,0,1]],j=bd(a,b),k=i.reduce(function(a,b){return[].concat(t(a),[Zc(j,b)])},[]).map(function(a){var b=s(a,4),c=b[0],d=b[1],g=b[2],h=b[3];return[c+e,d+f,g,h]}),l=Wb(k),m=s(l,2),n=s(m[0],2),o=n[0],p=n[1],q=s(m[1],2),r=q[0],u=q[1];return{x:o,y:r,width:p-o,height:u-r}}},{key:"_applyTransformToHandles",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.boxMatrix,c=void 0===b?Uc():b,d=this.options,e=d.rotatable,f=d.resizable,h=d.showNormal,i=this.storage,j=i.handles,k=i.controls,l=i.center;l=void 0===l?{}:l;var n=l.isShifted,o=void 0===n?!1:n,p=i.transform;p=void 0===p?{}:p;var q=p.controlsMatrix,r=void 0===q?bd(k,k.parentNode):q,t=$c(c,_c(r)),u=this._getVertices(t),v=u.anchor,w=void 0===v?null:v,x=u.center,y=m(u,["anchor","center"]),z=null,A={};e&&(z=h?[[w.x,w.y],y.rotator]:null,A={rotator:y.rotator});var B=g({te:[y.tl,y.tr],be:[y.bl,y.br],le:[y.tl,y.bl],re:[y.tr,y.br]},h&&z&&{normal:z});id(B).forEach(function(a){var b=s(B[a],2),c=b[0],d=b[1],e=od(c,d),f=e.cx,g=e.cy,h=e.length,i=e.theta;U(j[a]).css({transform:"translate(".concat(f,"px, ").concat(g,"px) rotate(").concat(i,"deg)"),width:"".concat(h,"px")})});var C=g({},f&&y,{},A,{},!o&&Boolean(x)&&{center:x});return id(C).reduce(function(a,b){var c=j[b],d=C[b];if(a[b]=d,O(d)||O(c))return a;var e=s(d,2),f=e[0],g=e[1];return U(c).css({transform:"translate(".concat(f,"px, ").concat(g,"px)")}),a},{})}},{key:"setCenterPoint",value:function(){L('"setCenterPoint" method is replaced by "setTransformOrigin" and would be removed soon'),this.setTransformOrigin.apply(this,arguments)}},{key:"setTransformOrigin",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.x,c=a.y,d=a.dx,e=a.dy,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,g=this.elements;g=void 0===g?[]:g;var h=s(g,1),i=h[0],j=this.storage,k=this.storage;k=void 0===k?{}:k;var l=k.wrapper,m=k.handles.center,n=k.center,o=this.options;o=void 0===o?{}:o;var p=o.container,q=N(d)&&N(e),r=N(b)&&N(c);if(m&&n&&(q||r)){var u,v,t=$c(bd(i,p),_c(bd(l,l.parentNode))),w=fd(i,p),x=s(w,2),y=x[0],z=x[1];if(q){var A=i.offsetHeight,B=i.offsetWidth,C=-d+B/2,D=-e+A/2,E=Zc(t,[C,D,0,1]),F=s(E,2);u=F[0],v=F[1]}else u=b,v=c;U(m).css({transform:"translate(".concat(u+y,"px, ").concat(v+z,"px)")}),n.isShifted=f,j.transformOrigin=Zc(Uc(),[u,v,0,1])}}},{key:"fitControlsToSize",value:function(){var a=this.storage,b=a.controls,c=a.center;c=void 0===c?{}:c;var d=c.isShifted,e=s(a.transformOrigin,2),f=e[0],h=e[1],i=bd(b,b.parentNode),j=Zc(i,[f,h,0,1]),k=s(j,2),l=k[0],m=k[1],n=[{nextValues:function(){return{x:l,y:m}},pin:!0,condition:function(){return d}},{nextValues:function(){return{dx:0,dy:0}},pin:!1,condition:function(){return!d}}].find(function(a){var b=a.condition;return b()}),o=n.nextValues,p=n.pin;this._updateControlsView(),this.setTransformOrigin(g({},o()),p),this._applyTransformToHandles()}},{key:"getBoundingRect",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=this.elements;b=void 0===b?[]:b;var c=s(b,1),d=c[0],e=this.options,f=e.scalable,h=e.restrict,i=e.container,j=this.storage,k=j.bBox,l=j.bBox;l=void 0===l?{}:l;var m=l.width,n=l.height,o=j.cached;o=void 0===o?{}:o;var p=o.bBox;p=void 0===p?{}:p;var q=p.width,r=void 0===q?m:q,t=p.height,u=void 0===t?n:t,v=f?k:g({},k,{width:r,height:u}),w=h||i;return pd(d,w,bd(d,w,a),v)}},{key:"applyAlignment",value:function(a){var b=this,c=this.elements,d=this.options.container,e=this._getVertices(),i=(e.anchor,e.rotator,e.center,m(e,["anchor","rotator","center"])),j=this._getRestrictedBBox(!0),k=kd(i),l=Wb(j),n=s(l,2),o=s(n[0],2),p=o[0],q=o[1],r=s(n[1],2),t=r[0],u=r[1],v=Wb(k),w=s(v,2),x=s(w[0],2),y=x[0],z=x[1],A=s(w[1],2),B=A[0],C=A[1],D=function(){switch(!0){case/[l]/.test(a):return p-y;case/[r]/.test(a):return q-z;case/[h]/.test(a):return(q+p)/2-(z+y)/2;default:return 0}},E=function(){switch(!0){case/[t]/.test(a):return t-B;case/[b]/.test(a):return u-C;case/[v]/.test(a):return(u+t)/2-(C+B)/2;default:return 0}},F=Zc(_c(Yc(bd(c[0].parentNode,d))),[D(),E(),0,1]),G=s(F,2),H=G[0],I=G[1],J=$c(dd(c[0]),Vc(H,I));c.map(function(a){return b._updateElementView(a,_b(Tc(J)))}),this.fitControlsToSize()}},{key:"getDimensions",value:function(){var a=this.elements;a=void 0===a?[]:a;var b=s(a,1),c=b[0],d=this.options.isGrouped,e=d?this._getGroupVertices():this._getElementVertices(c,Uc()),f=e.tl,g=e.tr,h=e.br;return{x:Vb(f[0]),y:Vb(f[1]),width:Vb(Math.sqrt(Math.pow(f[0]-g[0],2)+Math.pow(f[1]-g[1],2))),height:Vb(Math.sqrt(Math.pow(g[0]-h[0],2)+Math.pow(g[1]-h[1],2))),rotation:Vb(Math.atan2(g[1]-f[1],g[0]-f[0])*Sb)}}}]),e}(Rc),md=function(a){var b=s(a,2),c=b[0],d=b[1],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"handler",f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=qd(["sjx-hdl","sjx-hdl-".concat(e)]);return U(h).css(g({transform:"translate(".concat(c,"px, ").concat(d,"px)")},f)),h},nd=function(a,b){var c=s(a,3),d=c[0],e=c[1],f=c[2],g=void 0===f?1:f,h=od(d,e,g),i=h.cx,j=h.cy,k=h.length,l=h.theta,m=qd(["sjx-hdl-line","sjx-hdl-".concat(b)]);return U(m).css({transform:"translate(".concat(i,"px, ").concat(j,"px) rotate(").concat(l,"deg)"),height:"".concat(g,"px"),width:"".concat(k,"px")}),m},od=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,d=s(a,2),e=d[0],f=d[1],g=s(b,2),h=g[0],i=g[1],j=Math.sqrt((h-e)*(h-e)+(i-f)*(i-f)),k=(e+h)/2-j/2,l=(f+i)/2-c/2,m=Math.atan2(f-i,e-h)*(180/Math.PI);return{cx:k,cy:l,thickness:c,theta:m,length:j}},pd=function(a,b,c,d){var e=fd(a,b),f=s(e,2),g=f[0],h=f[1],i=d||{width:a.offsetWidth,height:a.offsetHeight,offset:{left:g,top:h}},j=i.width,k=i.height,l=i.offset;l=void 0===l?{}:l;var m=l.left,n=l.top,o=[[0,0,0,1],[j,0,0,1],[0,k,0,1],[j,k,0,1]];return o.reduce(function(a,b){return[].concat(t(a),[Zc(c,b)])},[]).map(function(a){var b=s(a,4),c=b[0],d=b[1],e=b[2],f=b[3];return[c+m,d+n,e,f]})},qd=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],b=document.createElement("div");return a.forEach(function(a){return Yb(b,a)}),b},rd=/\s*,\s*|\s+/g,sd=["circle","ellipse","image","line","path","polygon","polyline","rect","text","g","foreignobject","use"],ud=function(a,b){var c=td("svg").createSVGPoint();return c.x=a,c.y=b,c},vd=function af(a){var b=[];return Gd(a)?G.call(a.childNodes,function(a){if(1===a.nodeType){var c=a.tagName.toLowerCase();-1!==sd.indexOf(c)&&("g"===c&&b.push.apply(b,t(af(a))),b.push(a))}}):b.push(a),b},wd=function(){return td("svg").createSVGMatrix()},xd=function(a,b){var c=wd();return c.e=a,c.f=b,c},yd=function(a,b){var c=wd();return c.a=b,c.b=a,c.c=-a,c.d=b,c},zd=function(a,b){var c=wd();return c.a=a,c.d=b,c},Ad=function(a,b){var c;return null==b?wd():null==b.getScreenCTM?(c=wd(),c.inverse().multiply(wd())):(c=b.getScreenCTM&&b.getScreenCTM(),c.inverse().multiply(a.getScreenCTM()))},Bd=function(a){var b=a.a,c=a.b,d=a.c,e=a.d,f=a.e,g=a.f;return"matrix(".concat(b,",").concat(c,",").concat(d,",").concat(e,",").concat(f,",").concat(g,")")},Cd=function(a,b,c){return ud(b,c).matrixTransform(a)},Dd=function(a){var b=wd();return b.a=a.a,b.b=a.b,b.c=a.c,b.d=a.d,b.e=a.e,b.f=a.f,b},Ed=function(a){var b=a.a,c=a.b,d=a.c,e=a.d,f=a.e,g=a.f;return 1===b&&0===c&&0===d&&1===e&&0===f&&0===g},Fd=function(a){var b=a.tagName.toLowerCase();return-1===sd.indexOf(b)?(L('Selected element "'.concat(b,'" is not allowed to transform. Allowed elements:\n\n            circle, ellipse, image, line, path, polygon, polyline, rect, text, g')),!1):!0},Gd=function(a){return"g"===a.tagName.toLowerCase()},Hd=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a.replace(/[\n\r]/g,"").replace(/([^e])-/g,"$1 -").replace(/ +/g," ").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ")},Id=function(a){return Hd(a).trim().split(rd).reduce(function(a,b,c,d){return c%2===0&&a.push(d.slice(c,c+2)),a},[])},Jd=function(a,b){return Array.from(new Array(Math.ceil(a.length/b)),function(c,d){return a.slice(d*b,d*b+b)})},Kd=/\s*([achlmqstvz])([^achlmqstvz]*)\s*/gi,Ld=function(a){return[{size:2,condition:["M","m","L","l","T","t"].includes(a)},{size:1,condition:["H","h","V","v"].includes(a)},{size:6,condition:["C","c"].includes(a)},{size:4,condition:["S","s","Q","q"].includes(a)},{size:7,condition:["A","a"].includes(a)},{size:1,condition:!0}].find(function(a){var b=a.condition;return!!b})},Md=function(a){for(var b=Kd.lastIndex=0,c=[],d=function(){var a=b,d=s(a,3),e=d[1],f=d[2],g=e.toUpperCase(),h=e!==g,i=Hd(f),j=i.trim().split(rd).map(function(a){return isNaN(a)?void 0:Number(a)}),k=!1,l="M"===g,m=Ld(e),n=m.size;Jd(j,n).map(function(a){var b=k&&l;return k=k?k:l,c.push({relative:h,key:b?"L":g,cmd:b?h?"l":"L":e,values:a})})};b=Kd.exec(a);)d();return Qd(Pd(c))},Nd=function(a){var b=a.path,c=a.dx,d=a.dy;try{for(var e=Md(b),f="",g=" ",h=!0,i=0,j=e.length;i<j;i++){var k=e[i],l=k.values,m=k.key,n=k.relative,o=[];switch(m){case"M":for(var p=0,q=l.length;p<q;p+=2){var r=l.slice(p,p+2),u=s(r,2),v=u[0],w=u[1];(!n||h)&&(v+=c,w+=d),o.push(v,w),h=!1}break;case"A":for(var x=0,y=l.length;x<y;x+=7){var z=l.slice(x,x+7);n||(z[5]+=c,z[6]+=d),o.push.apply(o,t(z))}break;case"C":for(var A=0,B=l.length;A<B;A+=6){var C=l.slice(A,A+6);n||(C[0]+=c,C[1]+=d,C[2]+=c,C[3]+=d,C[4]+=c,C[5]+=d),o.push.apply(o,t(C))}break;case"H":for(var D=0,E=l.length;D<E;D+=1){var F=l.slice(D,D+1);n||(F[0]+=c),o.push(F[0])}break;case"V":for(var G=0,H=l.length;G<H;G+=1){var I=l.slice(G,G+1);n||(I[0]+=d),o.push(I[0])}break;case"L":case"T":for(var J=0,K=l.length;J<K;J+=2){var M=l.slice(J,J+2),N=s(M,2),O=N[0],P=N[1];n||(O+=c,P+=d),o.push(O,P)}break;case"Q":case"S":for(var Q=0,R=l.length;Q<R;Q+=4){var S=l.slice(Q,Q+4),T=s(S,4),U=T[0],V=T[1],W=T[2],X=T[3];n||(U+=c,V+=d,W+=c,X+=d),o.push(U,V,W,X)}break;case"Z":l[0]="",g=""}f+=m+o.join(",")+g}return f}catch(Y){L("Path parsing error: "+Y)}},Od=function(a){var b=a.path,c=a.localCTM;try{for(var d=Md(b),e="",f=" ",g=[],h=!0,i=0,j=d.length;i<j;i++){var k=d[i],l=k.values,m=k.key,n=k.relative,o=void 0===n?!1:n;switch(m){case"A":var p=[],q=Dd(c);o&&(q.e=q.f=0);for(var r=0,t=l.length;r<t;r+=7){var u=l.slice(r,r+7),v=s(u,7),w=v[0],x=v[1],y=v[2],z=v[3],A=v[4],B=v[5],C=v[6],D=Cd(q,B,C),E=D.x,F=D.y;p.push(Vb(E),Vb(F)),q.e=q.f=0;var G=Cd(q,w,x),H=G.x,I=G.y;p.unshift(Vb(H),Vb(I),y,z,A)}g.push(p);break;case"C":var J=[],K=Dd(c);o&&(K.e=K.f=0);for(var M=0,N=l.length;M<N;M+=6){var O=l.slice(M,M+6),P=s(O,6),Q=P[0],R=P[1],S=P[2],T=P[3],U=P[4],V=P[5],W=Cd(K,Q,R),X=W.x,Y=W.y,Z=Cd(K,S,T),$=Z.x,_=Z.y,ab=Cd(K,U,V),bb=ab.x,cb=ab.y;J.push(Vb(X),Vb(Y),Vb($),Vb(_),Vb(bb),Vb(cb))}g.push(J);break;case"H":var db=[],eb=Dd(c);o&&(eb.e=eb.f=0);for(var fb=0,gb=l.length;fb<gb;fb+=1){var hb=l.slice(fb,fb+1),ib=s(hb,1),jb=ib[0],kb=Cd(eb,jb,0),lb=kb.x;db.push(Vb(lb))}g.push(db);break;case"V":var mb=[],nb=Dd(c);o&&(nb.e=nb.f=0);for(var ob=0,pb=l.length;ob<pb;ob+=1){var qb=l.slice(ob,ob+1),rb=s(qb,1),sb=rb[0],tb=Cd(nb,0,sb),ub=tb.y;mb.push(Vb(ub))}g.push(mb);break;case"T":case"L":var vb=[],wb=Dd(c);o&&(wb.e=wb.f=0);for(var xb=0,yb=l.length;xb<yb;xb+=2){var zb=l.slice(xb,xb+2),Ab=s(zb,2),Bb=Ab[0],Cb=Ab[1],Db=Cd(wb,Bb,Cb),Eb=Db.x,Fb=Db.y;vb.push(Vb(Eb),Vb(Fb))}g.push(vb);break;case"M":var Gb=[],Hb=Dd(c);o&&!h&&(Hb.e=Hb.f=0);for(var Ib=0,Jb=l.length;Ib<Jb;Ib+=2){var Kb=l.slice(Ib,Ib+2),Lb=s(Kb,2),Mb=Lb[0],Nb=Lb[1],Ob=Cd(Hb,Mb,Nb),Pb=Ob.x,Qb=Ob.y;Gb.push(Vb(Pb),Vb(Qb)),h=!1}g.push(Gb);break;case"Q":var Rb=[],Sb=Dd(c);o&&(Sb.e=Sb.f=0);for(var Tb=0,Ub=l.length;Tb<Ub;Tb+=4){var Wb=l.slice(Tb,Tb+4),Xb=s(Wb,4),Yb=Xb[0],Zb=Xb[1],$b=Xb[2],_b=Xb[3],ac=Cd(Sb,Yb,Zb),bc=ac.x,cc=ac.y,dc=Cd(Sb,$b,_b),ec=dc.x,fc=dc.y;Rb.push(Vb(bc),Vb(cc),Vb(ec),Vb(fc))}g.push(Rb);break;case"S":var gc=[],hc=Dd(c);o&&(hc.e=hc.f=0);for(var ic=0,jc=l.length;ic<jc;ic+=4){var kc=l.slice(ic,ic+4),lc=s(kc,4),mc=lc[0],nc=lc[1],oc=lc[2],pc=lc[3],qc=Cd(hc,mc,nc),rc=qc.x,sc=qc.y,tc=Cd(hc,oc,pc),uc=tc.x,vc=tc.y;gc.push(Vb(rc),Vb(sc),Vb(uc),Vb(vc))}g.push(gc);break;case"Z":g.push([""]),f=""}e+=k.key+g[i].join(",")+f}return e.trim()}catch(wc){L("Path parsing error: "+wc)}},Pd=function(a){var b=null,c=null,d=null,e=null;return a.reduce(function(a,f){var i,g=f.cmd,h=f.values;switch(g){case"M":var j=s(h,2),k=j[0],l=j[1];i={key:"M",values:[k,l]},d=k,e=l,b=k,c=l;break;case"m":var m=s(h,2),n=m[0],o=m[1],p=b+n,q=c+o;i={key:"M",values:[p,q]},d=p,e=q,b=p,c=q;break;case"L":var r=s(h,2),u=r[0],v=r[1];i={key:"L",values:[u,v]},b=u,c=v;break;case"l":var w=s(h,2),x=w[0],y=w[1],z=b+x,A=c+y;i={key:"L",values:[z,A]},b=z,c=A;break;case"C":var B=s(h,6),C=B[0],D=B[1],E=B[2],F=B[3],G=B[4],H=B[5];i={key:"C",values:[C,D,E,F,G,H]},b=G,c=H;break;case"c":var I=s(h,6),J=I[0],K=I[1],L=I[2],M=I[3],N=I[4],O=I[5],P=[b+J,c+K,b+L,c+M,b+N,c+O];i={key:"C",values:[].concat(P)},b=P[4],c=P[5];break;case"Q":var Q=s(h,4),R=Q[0],S=Q[1],T=Q[2],U=Q[3];i={key:"Q",values:[R,S,T,U]},b=T,c=U;break;case"q":var V=s(h,4),W=V[0],X=V[1],Y=V[2],Z=V[3],$=[b+W,c+X,b+Y,c+Z];a.push({key:"Q",values:[].concat($)}),b=$[2],c=$[3];break;case"A":var _=s(h,7),ab=_[0],bb=_[1],cb=_[2],db=_[3],eb=_[4],fb=_[5],gb=_[6];i={key:"A",values:[ab,bb,cb,db,eb,fb,gb]},b=fb,c=gb;break;case"a":var hb=s(h,7),ib=hb[0],jb=hb[1],kb=hb[2],lb=hb[3],mb=hb[4],nb=hb[5],ob=hb[6],pb=b+nb,qb=c+ob;i={key:"A",values:[ib,jb,kb,lb,mb,pb,qb]},b=pb,c=qb;break;case"H":var rb=s(h,1),sb=rb[0];i={key:"H",values:[sb]},b=sb;break;case"h":var tb=s(h,1),ub=tb[0],vb=b+ub;i={key:"H",values:[vb]},b=vb;break;case"V":var wb=s(h,1),xb=wb[0];i={key:"V",values:[xb]},c=xb;break;case"v":var yb=s(h,1),zb=yb[0],Ab=c+zb;i={key:"V",values:[Ab]},c=Ab;break;case"S":var Bb=s(h,4),Cb=Bb[0],Db=Bb[1],Eb=Bb[2],Fb=Bb[3];i={key:"S",values:[Cb,Db,Eb,Fb]},b=Eb,c=Fb;break;case"s":var Gb=s(h,4),Hb=Gb[0],Ib=Gb[1],Jb=Gb[2],Kb=Gb[3],Lb=[b+Hb,c+Ib,b+Jb,c+Kb];i={key:"S",values:[].concat(Lb)},b=Lb[2],c=Lb[3];break;case"T":var Mb=s(h,2),Nb=Mb[0],Ob=Mb[1];i={key:"T",values:[Nb,Ob]},b=Nb,c=Ob;break;case"t":var Pb=s(h,2),Qb=Pb[0],Rb=Pb[1],Sb=b+Qb,Tb=c+Rb;i={key:"T",values:[Sb,Tb]},b=Sb,c=Tb;break;case"Z":case"z":i={key:"Z",values:[]},b=d,c=e}return[].concat(t(a),[i])},[])},Qd=function(a){var b=null,c=null,d=null,e=null,f=null,g=null,h=null;return a.reduce(function(a,i){var l,j=i.key,k=i.values;switch(j){case"M":var m=s(k,2),n=m[0],o=m[1];l=[{key:"M",values:[n,o]}],g=n,h=o,e=n,f=o;break;case"C":var p=s(k,6),q=p[0],r=p[1],u=p[2],v=p[3],w=p[4],x=p[5];l=[{key:"C",values:[q,r,u,v,w,x]}],c=u,d=v,e=w,f=x;break;case"L":var y=s(k,2),z=y[0],A=y[1];l=[{key:"L",values:[z,A]}],e=z,f=A;break;case"H":var B=s(k,1),C=B[0];l=[{key:"L",values:[C,f]}],e=C;break;case"V":var D=s(k,1),E=D[0];l=[{key:"L",values:[e,E]}],f=E;break;case"S":var K,L,F=s(k,4),G=F[0],H=F[1],I=F[2],J=F[3];"C"===b||"S"===b?(K=e+(e-c),L=f+(f-d)):(K=e,L=f),l=[{key:"C",values:[K,L,G,H,I,J]}],c=G,d=H,e=I,f=J;break;case"T":var P,Q,M=s(k,2),N=M[0],O=M[1];"Q"===b||"T"===b?(P=e+(e-c),Q=f+(f-d)):(P=e,Q=f);var R=e+2*(P-e)/3,S=f+2*(Q-f)/3,T=N+2*(P-N)/3,U=O+2*(Q-O)/3;l=[{key:"C",values:[R,S,T,U,N,O]}],c=P,d=Q,e=N,f=O;break;case"Q":var V=s(k,4),W=V[0],X=V[1],Y=V[2],Z=V[3],$=e+2*(W-e)/3,_=f+2*(X-f)/3,ab=Y+2*(W-Y)/3,bb=Z+2*(X-Z)/3;l=[{key:"C",values:[$,_,ab,bb,Y,Z]}],c=W,d=X,e=Y,f=Z;break;case"A":var cb=s(k,7),db=cb[0],eb=cb[1],fb=cb[2],gb=cb[3],hb=cb[4],ib=cb[5],jb=cb[6];if(0===db||0===eb)l=[{key:"C",values:[e,f,ib,jb,ib,jb]}],e=ib,f=jb;else if(e!==ib||f!==jb){var kb=Rd(e,f,ib,jb,db,eb,fb,gb,hb);l=kb.map(function(a){return{key:"C",values:a}}),e=ib,f=jb}break;case"Z":l=[i],e=g,f=h}return b=j,[].concat(t(a),t(l))},[])},Rd=function wf(a,b,c,d,e,f,g,h,i,j){var o,p,q,r,k=function(a){return Math.PI*a/180},l=function(a,b,c){return{x:a*Math.cos(c)-b*Math.sin(c),y:a*Math.sin(c)+b*Math.cos(c)}},m=k(g),n=[];if(j)o=j[0],p=j[1],q=j[2],r=j[3];else{var s=l(a,b,-m);a=s.x,b=s.y;var u=l(c,d,-m);c=u.x,d=u.y;var v=(a-c)/2,w=(b-d)/2,x=v*v/(e*e)+w*w/(f*f);x>1&&(x=Math.sqrt(x),e=x*e,f=x*f);var y=h===i?-1:1,z=e*e,A=f*f,B=z*A-z*w*w-A*v*v,C=z*w*w+A*v*v,D=y*Math.sqrt(Math.abs(B/C));q=D*e*w/f+(a+c)/2,r=D*-f*v/e+(b+d)/2,o=Math.asin(parseFloat(((b-r)/f).toFixed(9))),p=Math.asin(parseFloat(((d-r)/f).toFixed(9))),a<q&&(o=Math.PI-o),c<q&&(p=Math.PI-p),o<0&&(o=2*Math.PI+o),p<0&&(p=2*Math.PI+p),i&&o>p&&(o-=2*Math.PI),!i&&p>o&&(p-=2*Math.PI)}var E=p-o;if(Math.abs(E)>120*Math.PI/180){var F=p,G=c,H=d,I=i&&p>o?1:-1;p=o+120*Math.PI/180*I,c=q+e*Math.cos(p),d=r+f*Math.sin(p),n=wf(c,d,G,H,e,f,g,0,i,[p,F,q,r])}E=p-o;var J=Math.cos(o),K=Math.sin(o),L=Math.cos(p),M=Math.sin(p),N=Math.tan(E/4),O=4/3*e*N,P=4/3*f*N,Q=[a,b],R=[a+O*K,b-P*J],S=[c+O*M,d-P*L],T=[c,d];if(R[0]=2*Q[0]-R[0],R[1]=2*Q[1]-R[1],j)return[R,S,T].concat(t(n));n=[R,S,T].concat(t(n)).join().split(",");var U=[],V=[];return n.forEach(function(a,b){V.push(b%2?l(n[b-1],n[b],m).y:l(n[b],n[b+1],m).x),6===V.length&&(U.push(V),V=[])}),U},Sd=xb.E_DRAG,Td=xb.E_RESIZE,Ud=xb.E_ROTATE,Vd=yb.E_MOUSEDOWN,Wd=yb.E_TOUCHSTART,Xd=Object.keys,Yd=Object.entries,Zd=Object.values,$d=function(a){function e(){return b(this,e),c.apply(this,arguments)}h(e,a);var c=p(e);return d(e,[{key:"_init",value:function(a){var b=this,c=this.options,d=c.container,e=c.controlsContainer,f=c.resizable,h=c.rotatable,i=c.showNormal,j=c.transformOrigin,k=c.restrict,l=td("g",["sjx-svg-wrapper"]),n=td("g",["sjx-svg-controls"]),o=this._getVertices(),p=o.rotator,q=void 0===p?null:p,r=o.anchor,s=void 0===r?null:r,u=m(o,["rotator","anchor"]),v={},w={},x=Array.isArray(j)?Cd(wd(),j[0],j[1]):u.center;if(h){var y=i?ee([s,q],W,"normal"):null;i&&n.appendChild(y);var z=null;j&&(z=td("line",["sjx-hidden"]),z.x1.baseVal.value=u.center.x,z.y1.baseVal.value=u.center.y,z.x2.baseVal.value=x.x,z.y2.baseVal.value=x.y,ce(z,"#fe3232"),z.setAttribute("opacity",.5),n.appendChild(z)),w=g({},w,{normal:y,radius:z})}var A=f?{tl:u.tl,tr:u.tr,br:u.br,bl:u.bl,tc:u.tc,bc:u.bc,ml:u.ml,mr:u.mr}:{},B={te:[u.tl,u.tr],be:[u.bl,u.br],le:[u.tl,u.bl],re:[u.tr,u.br]};Xd(B).forEach(function(a){var b=B[a];O(b)||(v[a]=ee(b,W,a),n.appendChild(v[a]))});var C=g({},A,{rotator:q,center:j&&h?x:void 0});Xd(C).forEach(function(a){var b=C[a];if(!O(b)){var c=b.x,d=b.y,e="center"===a?"#fe3232":W;v[a]=be(c,d,e,a),n.appendChild(v[a])}}),l.appendChild(n),e.appendChild(l);var D=new WeakMap;a.map(function(a){return D.set(a,{parent:a.parentNode,transform:{ctm:Ad(a,d)},bBox:a.getBBox(),__data__:new WeakMap,cached:{}})});var E=k||d;this.storage={wrapper:l,controls:n,handles:g({},v,{},w),data:D,center:{isShifted:Array.isArray(j)},transformOrigin:x,transform:{containerMatrix:Ad(E,E.parentNode)},cached:{}},[].concat(t(a),[n]).map(function(a){return U(a).on(Vd,b._onMouseDown).on(Wd,b._onTouchStart)})}},{key:"_cursorPoint",value:function(a){var b=a.clientX,c=a.clientY,d=this.options.container;return this._applyMatrixToPoint(d.getScreenCTM().inverse(),b,c)}},{key:"_getRestrictedBBox",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,b=this.storage;b=void 0===b?{}:b;var c=b.transform;c=void 0===c?{}:c;var d=c.containerMatrix,e=this.options;e=void 0===e?{}:e;var f=e.container,g=e.restrict,h=g||f;return fe(h,a?Ad(h,f):d)}},{key:"_pointToTransform",value:function(a){var b=a.x,c=a.y,d=a.matrix,e=d.inverse();return e.e=e.f=0,this._applyMatrixToPoint(e,b,c)}},{key:"_pointToControls",value:function(a){var b=a.x,c=a.y,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.transform,e=d.controlsMatrix,f=e.inverse();return f.e=f.f=0,this._applyMatrixToPoint(f,b,c)}},{key:"_applyMatrixToPoint",value:function(a,b,c){var d=td("svg").createSVGPoint();return d.x=b,d.y=c,d.matrixTransform(a)
}},{key:"_applyTransformToElement",value:function(a,b){var c=this.storage;c=void 0===c?{}:c;var d=c.data,e=c.bBox,f=this.options;f=void 0===f?{}:f;var h=f.isGrouped,i=f.scalable,j=f.applyTranslate,k=d.get(a),l=k.cached,n=void 0===l?{}:l,o=m(k,["cached"]),p=o.transform,q=p.matrix,r=p.parentMatrix,s=o.__data__,t=n.scaleX,u=n.scaleY,v=n.dist;v=void 0===v?{}:v;var w=v.dx,x=v.dy,y=v.ox,z=v.oy,A=n.transformMatrix;if(b===Sd){if(!j||!w&&!x)return;var B=xd(y,z),C=B.multiply(q).multiply(B.inverse());this._updateElementView(["transform",C]),Gd(a)?vd(a).map(function(a){var b=xd(w,x),c=b.multiply(Ad(a,a.parentNode)).multiply(b.inverse());if(Ed(c)||a.setAttribute("transform",Bd(c)),!Gd(a)){var d=r.inverse();d.e=d.f=0;var e=Cd(d,y,z),f=e.x,g=e.y;_d(a,{x:f,y:g})}}):_d(a,{x:y,y:z})}if(b===Td){if(!A)return;if(!i)if(Gd(a)||h){var D=vd(a);D.forEach(function(b){if(!Gd(b)){var c=Ad(b,h?a.parentNode:a),d=c.inverse().multiply(A).multiply(c);ae(b,{dx:w,dy:x,scaleX:t,scaleY:u,localCTM:d,transformMatrix:A,bBox:e,__data__:s,isGrouped:h})}})}else ae(a,{dx:w,dy:x,scaleX:t,scaleY:u,localCTM:A,transformMatrix:A,bBox:e,__data__:s,isGrouped:h})}d.set(a,g({},o))}},{key:"_processActions",value:function(a){var b=this.storage,c=b.transform.controlsMatrix,d=b.center;d=void 0===d?{}:d;var e=d.isShifted,f=this.options.isGrouped;if(f&&a===Ud){this._applyTransformToHandles();var g=Cd(c,0,0),h=g.x,i=g.y;e&&this._moveCenterHandle(h,i),this._updateControlsView(),e||this.setTransformOrigin({dx:0,dy:0},!1)}}},{key:"_processResize",value:function(a,b){var c=b.dx,d=b.dy,e=this.storage,f=e.revX,h=e.revY,i=e.doW,j=e.doH,k=e.data,l=e.bBox,m=l.x,n=l.y,o=l.width,p=l.height,q=this.options,r=q.isGrouped,t=q.proportions,u=q.scalable,v=k.get(a),w=v.transform,x=w.matrix,y=w.auxiliary.scale.translateMatrix,z=v.cached,A=void 0===z?{}:z,B=function(a,b){var c=Math.max(1,o),d=Math.max(1,p),e=i||!i&&!j?(c+a)/c:(d+b)/d,f=t?c*e:c+a,g=t?d*e:d+b,h=f/c,k=g/d;return[h,k,f,g]},C=function(a,b){var c=zd(a,b);return y.multiply(c).multiply(y.inverse())},D=B(c,d),E=s(D,4),F=E[0],G=E[1],H=E[2],I=E[3],J=C(F,G),K=H-o,L=I-p,M=m-K*(j?.5:f?1:0),N=n-L*(i?.5:h?1:0),O=r?J.multiply(x):x.multiply(J);return u&&this._updateElementView(a,["transform",O]),k.set(a,g({},v,{cached:g({},A,{scaleX:F,scaleY:G,transformMatrix:J,resultMatrix:O})})),this._applyTransformToElement(a,Td),{x:M,y:N,width:H,height:I,transform:O}}},{key:"_processMove",value:function(a,b){var c=b.dx,d=b.dy,e=this.storage.data,f=e.get(a),h=f.transform,i=h.matrix,j=h.auxiliary.translate,k=j.translateMatrix,l=j.parentMatrix,m=f.cached;l.e=l.f=0;var n=Cd(l,c,d),o=n.x,p=n.y;e.set(a,g({},f,{cached:g({},m,{dist:{dx:Vb(c),dy:Vb(d),ox:Vb(o),oy:Vb(p)}})})),k.e=o,k.f=p;var q=k.multiply(i);return this._updateElementView(a,["transform",q]),q}},{key:"_processRotate",value:function(a,b){var c=this.storage;c=void 0===c?{}:c;var d=c.data,e=d.get(a),f=e.transform,g=f.matrix,h=f.parentMatrix,i=f.auxiliary.rotate.translateMatrix,j=Vb(Math.cos(b)),k=Vb(Math.sin(b)),l=yd(k,j);h.e=h.f=0;var m=h.inverse().multiply(l).multiply(h),n=i.multiply(m).multiply(i.inverse()),o=n.multiply(g);return this._updateElementView(a,["transform",o]),o}},{key:"_getElementState",value:function(a,b){var c=b.revX,d=b.revY,e=b.doW,f=b.doH,g=this.options,h=g.container,i=g.isGrouped,j=this.storage,k=j.data,l=j.controls,m=j.handles.center,n=j.transformOrigin,o=n.x,p=n.y,q=k.get(a),r=q.__data__;de(a,q,h),r["delete"](a),vd(a).forEach(function(b){r["delete"](b),de(b,q,a,i)});var s=this._getBBox(),t=s.x,u=s.y,v=s.width,w=s.height,x=Ad(a,a.parentNode),y=Ad(a,h),z=Ad(a.parentNode,h),A=z.inverse(),B=t+v*(f?.5:c?1:0),C=u+w*(e?.5:d?1:0),D=Ad(l,h),E=t+v/2,F=u+w/2,G=Cd(D,o,p),H=G.x,I=G.y,J=m?Cd(A,H,I):Cd(i?A:x,E,F),K=J.x,L=J.y,M=m?Cd(i?A:y.inverse(),H,I):Cd(i?A:wd(),B,C),N=M.x,O=M.y,P={auxiliary:{scale:{scaleMatrix:wd(),translateMatrix:xd(N,O)},translate:{parentMatrix:A,translateMatrix:wd()},rotate:{translateMatrix:xd(K,L)}},matrix:x,ctm:y,parentMatrix:z,scX:Math.sqrt(y.a*y.a+y.b*y.b),scY:Math.sqrt(y.c*y.c+y.d*y.d)};return{transform:P,bBox:s}}},{key:"_getCommonState",value:function(){var a=this.elements,b=this.options,c=b.isGrouped,d=b.container,e=b.restrict,f=this.storage,h=f.controls,i=f.handles.center,j=this._getBBox(),k=j.x,l=j.y,m=j.width,n=j.height,o=k+m/2,p=l+n/2,q=Ad(h,d),r=i?i.cx.baseVal.value:o,s=i?i.cy.baseVal.value:p,t=Cd(q,r,s),u=t.x,v=t.y,w=Cd(c?wd():Ad(a[0],d),o,p),x=w.x,y=w.y,z=e||d,A=Ad(z,z.parentNode),B=g({},this.storage.center||{},{x:i?u:x,y:i?v:y,hx:i?i.cx.baseVal.value:null,hy:i?i.cy.baseVal.value:null});return{transform:{containerMatrix:A,controlsMatrix:Ad(h,h.parentNode),controlsTranslateMatrix:wd(),wrapperOriginMatrix:xd(B.x,B.y)},bBox:j,center:B}}},{key:"_getVertices",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wd(),b=this.elements,c=this.options,d=c.isGrouped,e=c.rotatable,f=c.rotatorAnchor,g=c.rotatorOffset,h=c.container,i=this._getBBox(),j=i.x,k=i.y,l=i.width,m=i.height,n=l/2,o=m/2,p={tl:[j,k],tr:[j+l,k],mr:[j+l,k+o],ml:[j,k+o],tc:[j+n,k],bc:[j+n,k+m],br:[j+l,k+m],bl:[j,k+m],center:[j+n,k+o]},q=d?a:a.multiply(Ad(b[0],h)),r=Yd(p).reduce(function(a,b){var c=s(b,2),d=c[0],e=s(c[1],2),f=e[0],g=e[1];return a[d]=Cd(q,f,g),a},{});if(e){var t={},u=1;switch(f){case"n":var v=r.tc,w=v.x,x=v.y;t.x=w,t.y=x;break;case"s":var y=r.bc,z=y.x,A=y.y;t.x=z,t.y=A,u=-1;break;case"w":var B=r.ml,C=B.x,D=B.y;t.x=C,t.y=D,u=-1;break;case"e":default:var E=r.mr,F=E.x,G=E.y;t.x=F,t.y=G}var H="n"===f||"s"===f?Math.atan2(r.bl.y-r.tl.y,r.bl.x-r.tl.x):Math.atan2(r.tl.y-r.tr.y,r.tl.x-r.tr.x),I=g*u,J={x:t.x-I*Math.cos(H),y:t.y-I*Math.sin(H)};r.rotator=J,r.anchor=t}return r}},{key:"_getBBox",value:function(){var a=this.elements,b=this.options,c=b.container,d=b.isGrouped;if(d){var e=a.reduce(function(a,b){var d=Ad(b,c);return[].concat(t(a),t(fe(b,d)))},[]),f=Wb(e),g=s(f,2),h=s(g[0],2),i=h[0],j=h[1],k=s(g[1],2),l=k[0],m=k[1];return{x:i,y:l,width:j-i,height:m-l}}return a[0].getBBox()}},{key:"_moveCenterHandle",value:function(a,b){var c=this.storage,d=c.handles,e=d.center,f=d.radius,h=c.center,i=c.transform;i=void 0===i?{}:i;var j=i.controlsMatrix,k=void 0===j?wd():j,l=c.transformOrigin;l=void 0===l?{}:l;var m=l.x,n=l.y,o=c.cached;if(!O(e)){var p=m+a,q=n+b;e.cx.baseVal.value=p,e.cy.baseVal.value=q,f.x2.baseVal.value=p,f.y2.baseVal.value=q,this.storage=g({},this.storage,{center:g({},h,{isShifted:!0},Cd(k.inverse(),p,q)),cached:g({},o,{transformOrigin:Cd(wd(),p,q)})})}}},{key:"_processMoveRestrict",value:function(a,b){var c=b.dx,d=b.dy,e=this.storage.data,f=e.get(a),g=f.transform,h=g.matrix,i=g.auxiliary.translate.parentMatrix;i.e=i.f=0;var j=Cd(i,c,d),k=j.x,l=j.y,m=xd(k,l).multiply(h);return this._restrictHandler(a,m)}},{key:"_processRotateRestrict",value:function(a,b){var c=this.storage;c=void 0===c?{}:c;var d=c.data,e=d.get(a),f=e.transform,g=f.matrix,h=f.parentMatrix,i=f.auxiliary.rotate.translateMatrix,j=Vb(Math.cos(b)),k=Vb(Math.sin(b)),l=yd(k,j);h.e=h.f=0;var m=h.inverse().multiply(l).multiply(h),n=i.multiply(m).multiply(i.inverse()),o=n.multiply(g);return this._restrictHandler(a,o)}},{key:"_processResizeRestrict",value:function(a,b){var c=b.dx,d=b.dy,e=this.storage,f=e.doW,g=e.doH,h=e.data,i=e.bBox,j=i.width,k=i.height,l=this.options.proportions,m=h.get(a),n=m.transform,o=n.matrix,p=n.auxiliary.scale.translateMatrix,q=function(a,b){var c=Math.max(1,j),d=Math.max(1,k),e=f||!f&&!g?(c+a)/c:(d+b)/d,h=l?c*e:c+a,i=l?d*e:d+b,m=h/c,n=i/d;return[m,n,h,i]},r=function(a,b){var c=zd(a,b);return p.multiply(c).multiply(p.inverse())},s=o.multiply(r.apply(void 0,t(q(c,d))));return this._restrictHandler(a,s)}},{key:"_processControlsResize",value:function(){var a=this.storage;a=void 0===a?{}:a;var b=a.transform.controlsMatrix;this._applyTransformToHandles({boxMatrix:b.inverse()})}},{key:"_processControlsMove",value:function(a){var b=a.dx,c=a.dy,d=this.storage;d=void 0===d?{}:d;var e=d.transform,f=e.controlsMatrix,g=e.controlsTranslateMatrix,h=d.center;g.e=b,g.f=c;var i=g.multiply(f);if(this._updateControlsView(i),h.isShifted){var j=f.inverse();j.e=j.f=0;var k=Cd(j,b,c),l=k.x,m=k.y;this._moveCenterHandle(-l,-m)}}},{key:"_processControlsRotate",value:function(a){var b=a.radians,c=this.storage;c=void 0===c?{}:c;var d=c.transform,e=d.controlsMatrix,f=d.wrapperOriginMatrix,g=Vb(Math.cos(b)),h=Vb(Math.sin(b)),i=yd(h,g),j=f.multiply(i).multiply(f.inverse()).multiply(e);this._updateControlsView(j)}},{key:"_updateElementView",value:function(a,b){var c=s(b,2),d=c[0],e=c[1];"transform"===d&&a.setAttribute(d,Bd(e))}},{key:"_updateControlsView",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wd();this.storage.controls.setAttribute("transform",Bd(a)),this.storage.cached.controlsMatrix=a}},{key:"_applyTransformToHandles",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.boxMatrix,c=void 0===b?wd():b,d=this.options.rotatable,e=this.storage,f=e.handles,h=e.center.isShifted,i=this._getVertices(c),j=i.anchor,k=void 0===j?null:j,l=i.center,n=m(i,["anchor","center"]),o={te:[n.tl,n.tr],be:[n.bl,n.br],le:[n.tl,n.bl],re:[n.tr,n.br]};if(d){var p=f.normal,q=f.radius;N(p)&&(p.x1.baseVal.value=k.x,p.y1.baseVal.value=k.y,p.x2.baseVal.value=n.rotator.x,p.y2.baseVal.value=n.rotator.y),N(q)&&(q.x1.baseVal.value=l.x,q.y1.baseVal.value=l.y,h||(q.x2.baseVal.value=l.x,q.y2.baseVal.value=l.y))}Xd(o).forEach(function(a){var b=f[a],c=s(o[a],2),d=c[0],e=c[1];O(d)||O(b)||Yd({x1:d.x,y1:d.y,x2:e.x,y2:e.y}).map(function(a){var c=s(a,2),d=c[0],e=c[1];return b.setAttribute(d,e)})});var r=g({},n,{},!h&&Boolean(l)&&{center:l});return Xd(r).reduce(function(a,b){var c=f[b],d=r[b];return a[b]=d,O(d)||O(c)?a:(c.setAttribute("cx",d.x),c.setAttribute("cy",d.y),a)},{})}},{key:"setCenterPoint",value:function(){L('"setCenterPoint" method is replaced by "setTransformOrigin" and would be removed soon'),this.setTransformOrigin.apply(this,arguments)}},{key:"setTransformOrigin",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.x,c=a.y,d=a.dx,e=a.dy,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,g=this.elements,h=this.storage,i=this.storage;i=void 0===i?{}:i;var j=i.controls,k=i.handles;k=void 0===k?{}:k;var l=k.center,m=k.radius,n=i.center,o=this.options,p=o.container,q=o.isGrouped,r=N(d)&&N(e),s=N(b)&&N(c);if(n&&l&&m&&(r||s)){var v,w,t=Ad(j,j.parentNode).inverse(),u=q?t:t.multiply(Ad(g[0],p));if(r){var x=this._getBBox(),y=x.x,z=x.y,A=x.width,B=x.height,C=A/2,D=B/2,E=Cd(u,y+C+d,z+D+e);v=E.x,w=E.y}else v=b,w=c;l.cx.baseVal.value=v,l.cy.baseVal.value=w,m.x2.baseVal.value=v,m.y2.baseVal.value=w,n.isShifted=f,h.transformOrigin=Cd(wd(),v,w)}}},{key:"fitControlsToSize",value:function(){var a=this.storage,b=a.controls,c=a.center;c=void 0===c?{}:c;var d=c.isShifted,e=a.transformOrigin;e=void 0===e?{}:e;var f=e.x,h=e.y,i=Ad(b,b.parentNode),j=Cd(i,f,h),k=j.x,l=j.y,m=[{nextValues:function(){return{x:k,y:l}},pin:!0,condition:function(){return d}},{nextValues:function(){return{dx:0,dy:0}},pin:!1,condition:function(){return!d}}].find(function(a){var b=a.condition;return b()}),n=m.nextValues,o=m.pin;this._updateControlsView(),this.setTransformOrigin(g({},n()),o),this._applyTransformToHandles()}},{key:"getBoundingRect",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=this.options;c=void 0===c?{}:c;var d=c.restrict,e=c.container,f=d||e,g=b?Ad(a.parentNode,f).multiply(b):Ad(a,f);return fe(a,g,a.getBBox())}},{key:"applyAlignment",value:function(a){var b=this,c=this.elements,d=this.options.container,e=this._getVertices(),i=(e.anchor,e.rotator,e.center,m(e,["anchor","rotator","center"])),j=this._getRestrictedBBox(!0),k=Zd(i).map(function(a){var b=a.x,c=a.y;return[b,c]}),l=Wb(j),n=s(l,2),o=s(n[0],2),p=o[0],q=o[1],r=s(n[1],2),t=r[0],u=r[1],v=Wb(k),w=s(v,2),x=s(w[0],2),y=x[0],z=x[1],A=s(w[1],2),B=A[0],C=A[1],D=function(){switch(!0){case/[l]/.test(a):return p-y;case/[r]/.test(a):return q-z;case/[h]/.test(a):return(q+p)/2-(z+y)/2;default:return 0}},E=function(){switch(!0){case/[t]/.test(a):return t-B;case/[b]/.test(a):return u-C;case/[v]/.test(a):return(u+t)/2-(C+B)/2;default:return 0}};c.map(function(a){var c=Ad(a.parentNode,d);c.e=c.f=0;var e=Cd(c.inverse(),D(),E()),f=e.x,g=e.y,h=xd(f,g).multiply(Ad(a,a.parentNode));b._updateElementView(a,["transform",h])}),this.fitControlsToSize()}},{key:"getDimensions",value:function(){var a=this.elements,b=this.options,c=b.isGrouped,d=b.container,e=this._getBBox(),f=e.x,g=e.y,h=e.width,i=e.height,j={tl:[f,g],tr:[f+h,g],bl:[f,g+i],br:[f+h,g+i]},k=c?wd():Ad(a[0],d),l=Yd(j).reduce(function(a,b){var c=s(b,2),d=c[0],e=s(c[1],2),f=e[0],g=e[1];return a[d]=Cd(k,f,g),a},{}),m=l.tl,n=l.br,o=l.tr;return{x:Vb(m.x),y:Vb(m.y),width:Vb(Math.sqrt(Math.pow(m.x-o.x,2)+Math.pow(m.y-o.y,2))),height:Vb(Math.sqrt(Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2))),rotation:Vb(Math.atan2(o.y-m.y,o.x-m.x)*Sb)}}}]),e}(Rc),_d=function(a,b){var c=b.x,d=b.y,e=[];switch(a.tagName.toLowerCase()){case"text":var f=N(a.x.baseVal[0])?a.x.baseVal[0].value+c:(Number(a.getAttribute("x"))||0)+c,g=N(a.y.baseVal[0])?a.y.baseVal[0].value+d:(Number(a.getAttribute("y"))||0)+d;e.push(["x",f],["y",g]);break;case"foreignobject":case"use":case"image":case"rect":var h=N(a.x.baseVal.value)?a.x.baseVal.value+c:(Number(a.getAttribute("x"))||0)+c,i=N(a.y.baseVal.value)?a.y.baseVal.value+d:(Number(a.getAttribute("y"))||0)+d;e.push(["x",h],["y",i]);break;case"circle":case"ellipse":var j=a.cx.baseVal.value+c,k=a.cy.baseVal.value+d;e.push(["cx",j],["cy",k]);break;case"line":var l=a.x1.baseVal.value+c,m=a.y1.baseVal.value+d,n=a.x2.baseVal.value+c,o=a.y2.baseVal.value+d;e.push(["x1",l],["y1",m],["x2",n],["y2",o]);break;case"polygon":case"polyline":var p=Id(a.getAttribute("points")),q=p.map(function(a){return a[0]=Number(a[0])+c,a[1]=Number(a[1])+d,a.join(" ")}).join(" ");e.push(["points",q]);break;case"path":var r=a.getAttribute("d");e.push(["d",Nd({path:r,dx:c,dy:d})])}e.forEach(function(b){a.setAttribute(b[0],b[1])})},ae=function(a,b){var c=b.scaleX,d=b.scaleY,e=b.localCTM,f=b.bBox,g=f.width,h=f.height,i=b.__data__,j=b.transformMatrix,k=b.isGrouped,l=[],m=i.get(a);switch(a.tagName.toLowerCase()){case"text":case"tspan":var n=m.x,o=m.y,p=m.textLength,q=Cd(e,n,o),r=q.x,t=q.y;l.push(["x",r+(c<0?g:0)],["y",t-(d<0?h:0)],["textLength",Math.abs(c*p)]);break;case"circle":var u=m.r,v=m.cx,w=m.cy,x=u*(Math.abs(c)+Math.abs(d))/2,y=Cd(e,v,w),z=y.x,A=y.y;l.push(["r",x],["cx",z],["cy",A]);break;case"foreignobject":case"image":case"rect":if(k){var K=m.matrix,L=m.childCTM,M=L.inverse().multiply(j).multiply(L),N=K.multiply(M);l.push(["transform",Bd(N)])}else{var B=m.width,C=m.height,D=m.x,E=m.y,F=Cd(e,D,E),G=F.x,H=F.y,I=Math.abs(B*c),J=Math.abs(C*d);l.push(["x",G-(c<0?I:0)],["y",H-(d<0?J:0)],["width",I],["height",J])}break;case"ellipse":var O=m.rx,P=m.ry,Q=m.cx,R=m.cy,S=Cd(e,Q,R),T=S.x,U=S.y,V=wd();V.a=c,V.d=d;var W=Cd(V,O,P),X=W.x,Y=W.y;l.push(["rx",Math.abs(X)],["ry",Math.abs(Y)],["cx",T],["cy",U]);break;case"line":var Z=m.resX1,$=m.resY1,_=m.resX2,ab=m.resY2,bb=Cd(e,Z,$),cb=bb.x,db=bb.y,eb=Cd(e,_,ab),fb=eb.x,gb=eb.y;l.push(["x1",cb],["y1",db],["x2",fb],["y2",gb]);break;case"polygon":case"polyline":var hb=m.points,ib=Id(hb).map(function(a){var b=Cd(e,Number(a[0]),Number(a[1])),c=b.x,d=b.y;return a[0]=Vb(c),a[1]=Vb(d),a.join(" ")}).join(" ");l.push(["points",ib]);break;case"path":var jb=m.path;l.push(["d",Od({path:jb,localCTM:e})])}l.forEach(function(b){var c=s(b,2),d=c[0],e=c[1];a.setAttribute(d,e)})},be=function(a,b,c,d){var e=td("circle",["sjx-svg-hdl","sjx-svg-hdl-".concat(d)]),f={cx:a,cy:b,r:_rdius,fill:"#fff",stroke:c,"stroke-width":1,"fill-opacity":1,"vector-effect":"non-scaling-stroke"};return Yd(f).forEach(function(a){var b=s(a,2),c=b[0],d=b[1];return e.setAttribute(c,d)}),e},ce=function(a,b){a.setAttribute("stroke",b),a.setAttribute("stroke-dasharray","3 3"),a.setAttribute("vector-effect","non-scaling-stroke")},de=function(a,b,c,d){var e=null;switch(a.tagName.toLowerCase()){case"text":var f=N(a.x.baseVal[0])?a.x.baseVal[0].value:Number(a.getAttribute("x"))||0,h=N(a.y.baseVal[0])?a.y.baseVal[0].value:Number(a.getAttribute("y"))||0,i=N(a.textLength.baseVal)?a.textLength.baseVal.value:Number(a.getAttribute("textLength"))||null;e={x:f,y:h,textLength:i};break;case"circle":var j=a.r.baseVal.value,k=a.cx.baseVal.value,l=a.cy.baseVal.value;e={r:j,cx:k,cy:l};break;case"foreignobject":case"image":case"rect":var m=a.width.baseVal.value,n=a.height.baseVal.value,o=a.x.baseVal.value,p=a.y.baseVal.value;e={width:m,height:n,x:o,y:p};break;case"ellipse":var q=a.rx.baseVal.value,r=a.ry.baseVal.value,s=a.cx.baseVal.value,t=a.cy.baseVal.value;e={rx:q,ry:r,cx:s,cy:t};break;case"line":var u=a.x1.baseVal.value,v=a.y1.baseVal.value,w=a.x2.baseVal.value,x=a.y2.baseVal.value;e={resX1:u,resY1:v,resX2:w,resY2:x};break;case"polygon":case"polyline":var y=a.getAttribute("points");e={points:y};break;case"path":var z=a.getAttribute("d");e={path:z}}b.__data__.set(a,g({},e,{matrix:Ad(a,a.parentNode),ctm:Ad(a.parentNode,c),childCTM:Ad(a,d?c.parentNode:c)}))},ee=function(a,b,c){var d=s(a,2),e=d[0],f=d[1],g=td("line",["sjx-svg-line","sjx-svg-line-".concat(c)]),h={x1:e.x,y1:e.y,x2:f.x,y2:f.y,stroke:b,"stroke-width":1,"vector-effect":"non-scaling-stroke"};return Yd(h).forEach(function(a){var b=s(a,2),c=b[0],d=b[1];return g.setAttribute(c,d)}),g},fe=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.getBBox(),d=c.x,e=c.y,f=c.width,g=c.height,h=[[d,e],[d+f,e],[d+f,e+g],[d,e+g]];return h.map(function(a){var c=s(a,2),d=c[0],e=c[1],f=Cd(b,d,e),g=f.x,h=f.y;return[g,h]})},he=xb.EMITTER_EVENTS,ie=yb.E_MOUSEDOWN,je=yb.E_TOUCHSTART,ke=function(c){function f(a,c){var d;return b(this,f),d=e.call(this,a),d.enable(c),d}h(f,c);var e=p(f);return d(f,[{key:"_init",value:function(){var a=this,b=this.elements,c=this.options,d=U(b),e=c.style,f=c.appendTo,h=g({position:"absolute","z-index":"2147483647"},e),i=new WeakMap;b.map(function(a){return i.set(a,{parent:N(f)?U(f)[0]:document.body})}),this.storage={css:h,data:i},d.on(ie,this._onMouseDown).on(je,this._onTouchStart),he.slice(0,3).forEach(function(b){a.eventDispatcher.registerEvent(b)})}},{key:"_processOptions",value:function(b){var c={},d=null,e=document,f=M,g=M,h=M,i=M;if(N(b)){var j=b.style,k=b.appendTo,l=b.stack,m=b.onInit,n=b.onMove,o=b.onDrop,p=b.onDestroy;c=N(j)&&"object"===a(j)?j:c,d=k||null;var q=N(l)?U(l)[0]:document;f=Q(m),g=Q(n),h=P(o)?function(a){var b=this.storage;b=void 0===b?{}:b;var c=b.clone,d=$b(c,q);d&&o.call(this,a,this.elements,c)}:M,i=Q(p)}this.options={style:c,appendTo:d,stack:e},this.proxyMethods={onInit:f,onDrop:h,onMove:g,onDestroy:i}}},{key:"_start",value:function(a){var b=a.target,c=a.clientX,d=a.clientY,e=this.elements,f=this.storage,g=this.storage,h=g.data,i=g.css,j=e.find(function(a){return a===b||a.contains(b)});if(j){var k=h.get(j)||{},l=k.parent,m=void 0===l?j.parentNode:l,n=Xb(m),o=n.left,p=n.top;i.left="".concat(c-o,"px"),i.top="".concat(d-p,"px");var q=j.cloneNode(!0);U(q).css(i),f.clientX=c,f.clientY=d,f.cx=c,f.cy=d,f.clone=q,m.appendChild(q),this._draw()}}},{key:"_moving",value:function(a){var b=a.clientX,c=a.clientY,d=this.storage;d.clientX=b,d.clientY=c,d.doDraw=!0,d.doMove=!0}},{key:"_end",value:function(a){var b=this.storage,c=b.clone,d=b.frameId;b.doDraw=!1,E(d),O(c)||(this.proxyMethods.onDrop.call(this,a),c.parentNode.removeChild(c),delete b.clone)}},{key:"_animate",value:function(){var a=this.storage;a.frameId=D(this._animate);var b=a.doDraw,c=a.clientX,d=a.clientY,e=a.cx,f=a.cy,g=a.clone;b&&(a.doDraw=!1,this._drag({element:g,dx:c-e,dy:d-f}))}},{key:"_processMove",value:function(a,b){var c=b.dx,d=b.dy,e=this.storage;e=void 0===e?{}:e;var f=e.clone,g="translate(".concat(c,"px, ").concat(d,"px)");U(f).css({transform:g,webkitTranform:g,mozTransform:g,msTransform:g,otransform:g})}},{key:"_destroy",value:function(){var a=this.storage,b=this.proxyMethods,c=this.elements;O(a)||(U(c).off(ie,this._onMouseDown).off(je,this._onTouchStart),b.onDestroy.call(this,c),delete this.storage)}},{key:"disable",value:function(){this._destroy()}}]),f}(Pb),me=function(a){function e(){return b(this,e),c.apply(this,arguments)}h(e,a);var c=p(e);return d(e,[{key:"drag",value:function(){return ge.call.apply(ge,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"clone",value:function(){return le.call.apply(le,[this].concat(Array.prototype.slice.call(arguments)))}}]),e}(R);return Object.defineProperty(ne,"createObservable",{value:function(){return new Hb}}),Object.defineProperty(ne,"Subjx",{value:me}),Object.defineProperty(ne,"Observable",{value:Hb}),ne});